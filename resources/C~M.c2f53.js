(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{543:function(e,t,n){var i=n(463),a=n(536),r=n(624),o=n(810),s=n(811),c=a.extend({attrs:{triggers:{value:[],getter:function(e){return i(e)}},panels:{value:[],getter:function(e){return i(e)}},classPrefix:'u-switchable',hasTriggers:!0,triggerType:'hover',delay:100,activeIndex:{value:0,setter:function(e){return parseInt(e)||0}},step:1,length:{readOnly:!0,getter:function(){return Math.ceil(this.get('panels').length/this.get('step'))}},viewSize:[],triggerViewSize:[],panelViewSize:[],activeTriggerClass:{getter:function(e){return e||this.get('classPrefix')+'-active'}}},setup:function(){this._initConstClass(),this._initElement();var e=this._getDatasetRole();this._initPanels(e),this._initTriggers(e),this._bindTriggers(),this._initPlugins(),this.render()},_initConstClass:function(){var e;this.CONST={UI_SWITCHABLE:(e=this.get('classPrefix'))||'',NAV_CLASS:e?e+'-nav':'',CONTENT_CLASS:e?e+'-content':'',TRIGGER_CLASS:e?e+'-trigger':'',PANEL_CLASS:e?e+'-panel':'',PREV_BTN_CLASS:e?e+'-prev-btn':'',NEXT_BTN_CLASS:e?e+'-next-btn':''}},_initElement:function(){this.element.addClass(this.CONST.UI_SWITCHABLE)},_getDatasetRole:function(){var e=this,t={};return i.each(['trigger','panel','nav','content'],(function(n,i){var a=e.$('[data-role='+i+']');a.length&&(t[i]=a)})),t},_initPanels:function(e){var t=this.get('panels'),n=this.get('panelViewSize');if(t.length>0||(e.panel?this.set('panels',t=e.panel):e.content&&(this.set('panels',t=e.content.find('> *')),this.content=e.content)),0===t.length)throw new Error('panels.length is ZERO');n[0]&&t.css({width:n[0],height:n[1]}),this.content||(this.content=t.parent()),this.content.addClass(this.CONST.CONTENT_CLASS),this.get('panels').addClass(this.CONST.PANEL_CLASS)},_initTriggers:function(e){var t=this.get('triggers'),n=this.get('triggerViewSize');t.length>0||(e.trigger?this.set('triggers',t=e.trigger):e.nav?(0===(t=e.nav.find('> *')).length&&(t=l(this.get('length'),this.get('activeIndex'),this.get('activeTriggerClass'),!0).appendTo(e.nav)),this.set('triggers',t),this.nav=e.nav):this.get('hasTriggers')&&(this.nav=l(this.get('length'),this.get('activeIndex'),this.get('activeTriggerClass')).appendTo(this.element),this.set('triggers',t=this.nav.children()))),n[0]&&t.css({width:n[0],height:n[1]}),!this.nav&&t.length&&(this.nav=t.parent()),this.nav&&this.nav.addClass(this.CONST.NAV_CLASS),t.addClass(this.CONST.TRIGGER_CLASS).each((function(e,t){i(t).data('value',e)}))},_bindTriggers:function(){var e=this,t=this.get('triggers');function n(t){e._onFocusTrigger(t.type,i(this).data('value'))}'click'===this.get('triggerType')?t.click(n):t.hover(n,(function(){clearTimeout(e._switchTimer)}))},_onFocusTrigger:function(e,t){var n=this;'click'===e?this.switchTo(t):this._switchTimer=setTimeout((function(){n.switchTo(t)}),this.get('delay'))},_initPlugins:function(){this._plugins=[],this._plug(r),this._plug(o),this._plug(s)},switchTo:function(e){this.set('activeIndex',e)},_onRenderActiveIndex:function(e,t){this._switchTo(e,t)},_onRenderPanelViewSize:function(e,t){var n=this.get('panels'),i=this.get('viewSize'),a=this.get('step'),r=n.eq(0);t&&e&&(n.css({width:e[0],height:e[1]}),i[0]=r.outerWidth()*a,i[1]=r.outerHeight()*a,this.set('viewSize',i),this.next())},_onRenderTriggerViewSize:function(e,t){var n=this.get('triggers');e&&t&&n.css({width:e[0],height:e[1]})},_switchTo:function(e,t){this.trigger('switch',e,t),this._switchTrigger(e,t),this._switchPanel(this._getPanelInfo(e,t)),this.trigger('switched',e,t),this._isBackward=undefined},_switchTrigger:function(e,t){var n=this.get('triggers');n.length<1||(n.eq(t).removeClass(this.get('activeTriggerClass')),n.eq(e).addClass(this.get('activeTriggerClass')))},_switchPanel:function(e){e.fromPanels.hide(),e.toPanels.show()},_getPanelInfo:function(e,t){var n,a,r=this.get('panels').get(),o=this.get('step');return t>-1&&(n=r.slice(t*o,(t+1)*o)),a=r.slice(e*o,(e+1)*o),{toIndex:e,fromIndex:t,toPanels:i(a),fromPanels:i(n)}},prev:function(){this._isBackward=!0;var e=(this.get('activeIndex')-1+this.get('length'))%this.get('length');this.switchTo(e)},next:function(){this._isBackward=!1;var e=(this.get('activeIndex')+1)%this.get('length');this.switchTo(e)},_plug:function(e){var t=e.attrs;if(t)for(var n in t)t.hasOwnProperty(n)&&!(n in this.attrs)&&this.set(n,t[n]);e.isNeeded.call(this)&&(e.install&&e.install.call(this),this._plugins.push(e))},destroy:function(){var e=this;i.each(this._plugins,(function(t,n){n.destroy&&n.destroy.call(e)})),c.superclass.destroy.call(this)}});function l(e,t,n,a){for(var r=i('<ul>'),o=0;o<e;o++){i('<li>',{'class':o===t?n:'',html:o+1}).appendTo(r)}return a?r.children():r}e.exports=c},545:function(e,t,n){(function(t){var i=n(468).get,a=n(467),r=n(474),o=r.getFolderCategory,s=r.cachedMboxaTreeBy;undefined;var c=i('mail.enablesendmail'),l=i('mail.enablewebmailcompose'),d=i('mail.enablewebmailreplycompose'),u=i('mail.enablewebmailforwardcompose'),h=i('setting.enabledirectforward'),m=i('mail.supportRecallMail'),f={locale:a.getConfig('context.locale'),supportPab:a.getConfig('user.supportpab'),supportOab:a.getConfig('user.supportoab'),enableSendMail:c,enableScheduleInvitation:a.getConfig('mail.enablescheduleinvitation'),permWebmailMailSearch:a.getConfig('user.permwebmailmailsearch'),enableSecurityLevel:n(482).enabled,supportSMIME:a.getConfig('user.supportsmime'),openSMIMEKeyPass:a.getConfig('mail.opensmimekeypass'),checkCookie:a.getConfig('user.checkcookie'),supportRecallMail:m};function p(e){var r=function(){return function(e,n){var r=n?s('id',n)||{}:{rw:!0,send:c},p=!!r.rw,g=!!r.send;t.assign(e,f,{forceSendReadReceipt:a.getConfig('mail.forcesendreadreceipt'),enableSpamForwhand:a.getConfig('setting.enablespamforwhand'),enableListBriefText:a.getConfig('user.enablelistbrieftext'),enableDeferMail:a.getConfig('mail.enabledefermail'),enableMailMemo:a.getConfig('mail.enablemailmemo'),enableMailFlagged:!!i('mail.label0Count'),enableMailDealings:a.getConfig('mail.enablemaildealings'),enableDeliveryStatus:a.getConfig('mail.enabledeliverystatus'),mailFlaggedColorCount:i('mail.label0Count'),deliveryStatusKeepDays:a.getConfig('mail.deliverystatuskeepdays'),deliveryStatusBeginTime:a.getConfig('mail.deliverystatusbegintime'),enableSendMail:g,enableForward:g&&u,enableCompose:g&&l,enableForwardd:g&&h,enableReply:g&&d,enableQuickReply:g&&a.getConfig('mail.enablequickreply'),enableDelete:p&&i('mail.enableDelete'),enableMoveTo:i('mail.enableMoveTo'),enableRealDelete:i('mail.enableRealDelete'),shareMailBoxFolder:i('mail.enablemailboxview')&&'shareFolder'===o(n),archiveLiteFolder:i('user.supportarchivelite')&&'archiveFolder'===o(n),enableUpdateMailStatus:p,supportRecallMail:n?g:m})}(p,e.state.param.mboxa)},p=e.config={exec:r};return r(),n(819)(e,p),p}e.exports=p,p.compose=function(){return t.assign({},f,{enableForward:u,enableForwardd:c&&h,enableReply:d,enableCompose:l,smtpMaxSendMailSize:a.getConfig('user.smtpmaxsendmailsize'),forbidDownload:a.getConfig('user.forbiddownload'),enableDeliverWithSms:a.getConfig('user.enabledeliverwithsms'),enableMailCipher:a.getConfig('user.enablemailcipher'),enableAutoDel:a.getConfig('user.enableautodel'),enableShowOneRcpt:a.getConfig('mail.enableshowonercpt'),supportSMIMEClient:f.supportSMIME&&!a.getConfig('user.syssupportsmime')&&n(481).IE,supportSMIMEServer:f.supportSMIME&&a.getConfig('user.syssupportsmime'),enableSaveDraft:a.getConfig('mail.enablesavedraft'),autoSaveDraftInterval:a.getConfig('mail.autosavedraftinterval'),encryptedCheckedDefault:a.getConfig('mail.encryptedcheckeddefault'),smimeUploadAttachSizeLimit:Math.min(a.getConfig('mail.smimeuploadattachsizelimit'),a.getConfig('user.smtpmaxsendmailsize')),domainName:a.getConfig('user.uid').replace(/.*@/,''),enableMailTemplate:a.getConfig('mail.enablemailtemplate'),enableMultiRcptsAlert:a.getConfig('mail.enablemultircptsalert'),supportTimeZone:a.getConfig('setting.timesendsupporttimezone')&&/^\(UTC/.test(a.getConfig('setting.timezonevalues')[0]),timeZoneValues:a.getConfig('setting.timezonevalues'),timeZoneId:a.getConfig('setting.timezoneid'),enableQueryReadStatus:a.getConfig('user.enablequeryreadstatus')})}}).call(this,n(464))},581:function(e,t,n){var i=n(543);e.exports=i.extend({})},624:function(e,t,n){var i=n(463);n(809);e.exports=t={attrs:{effect:'none',easing:'linear',duration:500},isNeeded:function(){return'none'!==this.get('effect')},install:function(){var e=this.get('panels');e.show();var t=this.get('effect'),n=this.get('step'),r=i.isFunction(t);if(r||0!==t.indexOf('scroll')){if(!r&&'fade'===t){var o=this.get('activeIndex')*n,s=o+n-1;e.each((function(e,t){var n=e>=o&&e<=s;i(t).css({opacity:n?1:0,position:'absolute',zIndex:n?9:1})}))}}else{var c=this.content,l=e.eq(0);c.css('position','relative'),'static'===c.parent().css('position')&&c.parent().css('position','relative'),'scrollx'===t&&(e.css('float','left'),c.width('35791197px'));var d=this.get('viewSize');if(d[0]||(d[0]=l.outerWidth()*n,d[1]=l.outerHeight()*n,this.set('viewSize',d)),!d[0])throw new Error('Please specify viewSize manually')}this._switchPanel=function(e){var t=this.get('effect');(i.isFunction(t)?t:a[t]).call(this,e)}}};var a={fade:function(e){if(this.get('step')>1)throw new Error('Effect "fade" only supports step === 1');var t=e.fromPanels.eq(0),n=e.toPanels.eq(0);if(this.anim&&this.anim.stop(!1,!0),n.css('opacity',1),n.show(),e.fromIndex>-1){var i=this,a=this.get('duration'),r=this.get('easing');this.anim=t.animate({opacity:0},a,r,(function(){i.anim=null,n.css('zIndex',9),t.css('zIndex',1),t.css('display','none')}))}else n.css('zIndex',9)},scroll:function(e){var t='scrollx'===this.get('effect'),n=this.get('viewSize')[t?0:1]*e.toIndex,i={};if(i[t?'left':'top']=-n+'px',this.anim&&this.anim.stop(),e.fromIndex>-1){var a=this,r=this.get('duration'),o=this.get('easing');this.anim=this.content.animate(i,r,o,(function(){a.anim=null}))}else this.content.css(i)}};a.scrolly=a.scroll,a.scrollx=a.scroll,t.Effects=a},632:function(e,t,n){(function(t,i,a){var r=n(467).getUser,o=n(468).get,s=n(473).h,c=n(470).alert,l=function(e){return t(e).contents().find('body')};e.exports=function(e,d,u,h,m){var f=t('<iframe class=j-mail-content width=100% src="jsp/viewMailHTML.jsp?CSP='+(d.sMimeClientEncrypted?'':!n(481).IE||'" sandbox="allow-same-origin allow-popups')+'" frameborder=0 allowTransparency=true referrerpolicy=no-referrer>').on('load',(function(){var e=f[0].contentWindow,i=f.contents();i.click((function(){t(document).trigger('hide.menu')})),h&&r().shortcut&&i.keydown((function(e){var t={82:'reply',65:'replyall',70:'forward',46:'delete'}[e.which];t&&!e.ctrlKey&&h(t,d.id)}));r().translate&&o('user.enableTranslate')&&(l(f).addClass('translate-wrapper'),i.mouseup((function(t){var a=(''+(e.getSelection&&e.getSelection()||i[0].getSelection&&i[0].getSelection()||i[0].selection&&i[0].selection.createRange().text||'')).trim();!function(e,t,i){var a=(r().translate_condition||'').split(','),o=a[0],s=a[1];n(838)(e,o,s)(t,i)}(f,a,t)})));n(832)(e)}));return e.find('.mail-content').append(f),n(833).resize(f,{initCallback:i.fn(u,(function(e){var r=l(f)[0];r.innerHTML=e.id?e.mainPartData.content:e;var o=n(526),u=t('img',r).click((function(){o(u,u.index(this))}));t('a',r).each((function(){var e=t(this),r=e[0].href;if(e.attr('data-auto-link'))for(var o=e.parent()[0];o&&1===o.nodeType;){var l=o.style.color||o.color;if(l){e.css('color',l);break}o=o.parentNode}r&&e.click(i.stop((function(){return function(e,t){e.sspurl?n(835)(t):open(t,'_blank')||c(s(a('common/mail_open_url_fail'),t))}(d,r)})))}))})),resizedCallback:function(e){var t=m||f.parent().width()>+e.width?'100%':e.width+'px',n=e.height+'px';parseFloat(t)&&parseFloat(n)&&f.css({width:t,height:n})}}),f}}).call(this,n(463),n(464),n(465))},633:function(e,t,n){(function(t,i,a){var r=n(464),o=n(581),s=n(478),c=n(468).get,l=n(473),d=n(488).bytesToSize,u=n(634),h=n(582).save,m=n(470).alert,f=n(526),p=n(467),g=p.getUser,v=p.detachURL,b=n(521),y=n(844);e.exports=function(e,p,_){var w=p.mid,C=p.mboxa,N=p.mailCipherPassword,T=r.assign({},p),x=S('attachments'),M=S('trsAttachments',1);function S(e,i){return T[e]=r.map(p[e],(function(e){return w?function(e,i,a){var o,l,d='javascript:void(0)';if(i){var u=r.pickBy({part:e.id,mid:w,mboxa:C,mailCipherPassword:N}),h=s.path('mbox-data',u)+'&mode=';d=h+'download',o=e.isMsg?v('mail.read',u):h+'inline',l=h+'preview'}else a&&(d=t.wmURL({url:'viewDownloadFile.jsp?key='+e.key+'&code='+e.code+'&locale='+s.locale()}));var m=n(474),f=i&&!(m.cachedMboxaTreeBy('id',C)||0).remote,g=n(539).checkFile(e.filename,e.estimateSize||e.contentLength),y=c('user.enablepreview')&&!p.mailCipherEncrypted&&f&&g.type,_=c('user.allowdownloadattachment'),T=c('user.supportnf')&&c('file.savetonf')&&f,x=T&&b.xnfTokens[0],M={preview:y&&r.assign({},g,{url:l}),open:i&&_&&c('mail.enableAllowOpenAttachment'),download:(!i||_)&&{url:d},nf:T,xnf:x};return r.assign({},e,{},M,{actions:r.some(M),openUrl:o})}(e,!_&&!i,i):e}))}T.packUrl=(x[0]||0).download&&!(p.flags||0).encrypted&&t.wmURL({url:'common/mbox/packMessage.jsp',part:r.map(x,'id'),mid:w,mboxa:C}),e.html(!p.smimeAttachs&&x.concat(M)[0]?y(T):'').on('click','.action-item a',(function(e){var t=i(this).closest('ul').attr('data-id');t&&I[i(this).attr('rel')](t,r.find(x,{id:t}),e)})),x[0]&&M[0]&&new o({element:e.find('.j-tab-wrap'),triggers:e.find('.j-tab-trigger'),panels:e.find('.j-tab-panels'),activeIndex:0,triggerType:'click',activeTriggerClass:'z-current'});var k=r.fn(u,r,w,C,N);e.on('click','.j-saveToNetFolder',r.fn(k,r.map(x,'id')));var I={nf:k,xnf:function(e,t){var n=t.filename;h([w+'/'+e],C,''+n)},preview:function(e,t,n){var i=t.preview;if('IMG'===i.type){r.stop(n);var o=r.groupBy(x,'preview.type').IMG.map((function(e){return{src:e.openUrl,alt:e.filename,id:e.id}}));f(o,o.findIndex(r.biz({id:e})))}else i.sizeExceed&&(r.stop(n),m(l(a('mail/attachment_size_limit'),d(i.sizeLimit,2))))},download:function(e,t){_&&_.cmPlugin.encode().decodeBase64AndSave(t.base64,t.fileName)},open:function(e,t,i){var a=t.filename,o=t.openUrl;if('wps'===r.mapFind(g().addonOpen,(function(e,t){return RegExp('\\.('+e+')$','i').test(a)&&t}))){r.stop(i);var s=r.fn(open,o);n.e(21).then(function(e){return n(1094)(o,a,s)}.bind(null,n))['catch'](n.oe)}}}}}).call(this,n(466),n(463),n(465))},635:function(e,t,n){var i=n(505),a=n(845),r=n(847),o=n(465),s=n(488),c=n(513),l=n(463);function d(e,t){try{new ActiveXObject('CAPICOM.Certificates'),new ActiveXObject('CAPICOM.EnvelopedData'),new ActiveXObject('CAPICOM.Certificate'),new ActiveXObject('CAPICOM.SignedData'),new ActiveXObject('CAPICOM.Signer'),new ActiveXObject('CAPICOM.Attribute')}catch(n){this.invaild=!0,u(o('mail/plugin_loadfailed'))}e.version?function(e,t){var n=e.split('.'),i=t.split('.');function a(e){for(var t=0;t<e.length;++t)if(n=e[t],!/^\d+$/.test(n))return!1;var n;return!0}if(!a(n)||!a(i))return NaN;for(var r=0;r<n.length;++r){if(i.length===r)return 1;if(n[r]!==i[r])return n[r]>i[r]?1:-1}if(n.length!=i.length)return-1;return 0}(e.version,'4.0.5.0')>=0?this.cmPlugin=e:(this.invaild=!0,u(o('mail/plugin_version_error'),'/cab/cmplugin_setup.exe')):(this.invaild=!0,u(o('mail/cmplugin_loadfail'),'/cab/cmplugin_setup.exe')),t&&this.parseMail(t)}function u(e,t){i.confirm(e,l.noop(),l.noop(),{onConfirm:function(){this.hide(),t=t||window.location.href.replace(/index.jsp(.+)/,'jsp/pluginInstall.jsp'),window.open(t)},onCancel:function(){this.hide()},title:o('main/tip_title')})}function h(e){for(var t=0,n=e.length,i='';t<n;t+=2){var a=parseInt(e.substr(t,2),16);a&&(i+=String.fromCharCode(a))}return i}function m(e){var t,n,i,a,r=e.length,o='';for(t=0;t<r;t++)for(i=unescape(encodeURIComponent(e.substr(t,1))),n=0;n<i.length;n++)o+=(a=i.charCodeAt(n).toString(16)).length>1?a:'0'+a;return o}d.prototype.parseMail=function(e){var t=new a(this.cmPlugin),n=this;t.on('end',(function(e){var t=e.headers['content-type'];if(n.signed=t.indexOf('signed-data')>-1,n.encrypted=t.indexOf('enveloped-data')>-1,n.attachments=[],!e.text&&e.attachments&&'smime.p7m'==e.attachments[0].fileName){var i=e.attachments[0];n.mailContent=i.originalContent,n.attachments.push({id:0,fileName:i.fileName,base64:i.content,fileType:i.fileName.split('.').pop()})}else n.mailContent=e.text||'',e.attachments&&l.each(e.attachments,(function(e,t){n.attachments.push({id:e,fileName:t.fileName,base64:t.content,fileType:t.fileName.split('.').pop(),size:s.bytesToSize(t.length),length:t.length})}))}),null),t.end(e)},d.prototype.setBaseMailInfo=function(e,t){var n,i,a=new r(null,null,this.cmPlugin);if(this.rootNodeHeaders={from:e.account,to:e.to,cc:e.cc,bcc:e.bcc,subject:e.subject,'Content-Transfer-Encoding':'base64'},a.addHeader(this.rootNodeHeaders,null),t.length>0)for(a.setHeader('Content-Type','multipart/mixed'),(n=new r('text/plain',null,this.cmPlugin)).addHeader({'Content-Transfer-Encoding':'8bit'},null).setContent(e.content,'plain'),a.appendChild(n),i=0;i<t.length;i++)(n=new r(null,{filename:t[i].fileName},this.cmPlugin)).addHeader({'Content-Transfer-Encoding':'base64','Content-Disposition':'attachment'},null).setContent(t[i].base64,'base64'),a.appendChild(n);else a.setHeader({'Content-Transfer-Encoding':'8bit'},null),a.setContent(e.content,'plain').setHeader('Content-Type','text/plain');this.prevMimeNode=a},d.prototype.encryptMail=function(e,t,n){var a,s,c,l,d=new ActiveXObject('CAPICOM.EnvelopedData'),u=new ActiveXObject('CAPICOM.Utilities');try{for(a in t)t.hasOwnProperty(a)&&((c=new ActiveXObject('CAPICOM.Certificate')).Import(t[a]),d.Recipients.Add(c));return(c=new ActiveXObject('CAPICOM.Certificate')).Import(e.Export()),d.Recipients.Add(c),l=m(n?this.mimeNode.build():this.prevMimeNode.build()),d.Content=u.HexToBinary(l),s=d.Encrypt(0),this.mimeNode=new r('application/pkcs7-mime; smime-type=\'enveloped-data\'; name=\'smime.p7m\'',{filename:'smime.p7m'},this.cmPlugin),this.mimeNode.setContent(s,'base64').setHeader(this.rootNodeHeaders),!0}catch(h){return i.alert(o('mail/msg_get_receiver_cert_fail')),!1}},d.prototype.decryptMail=function(){if(this.encrypted)try{var e=this.mailContent,t=new ActiveXObject('CAPICOM.EnvelopedData'),n=new ActiveXObject('CAPICOM.utilities');return t.Decrypt(e),e=h(n.BinaryToHex(t.Content)),this.parseMail(e),!0}catch(a){return i.alert(o('mail/ERRSTR_OPEN_CERT_STORE_ABORTING')+a.description),!1}return!1},d.prototype.signMail=function(e){var t,n,i=new ActiveXObject('CAPICOM.Signer'),a=new ActiveXObject('CAPICOM.SignedData'),o=new ActiveXObject('CAPICOM.Utilities'),s=new ActiveXObject('CAPICOM.Attribute'),c=new Date;try{return i.Certificate=e,s.Name=0,s.Value=c.getVarDate(),i.AuthenticatedAttributes.Add(s),n=m(this.prevMimeNode.build()),a.Content=o.HexToBinary(n),t=a.Sign(i,!1,0),this.mimeNode=new r('application/pkcs7-mime; smime-type=\'signed-data\'; name=\'smime.p7m\'',{filename:'smime.p7m'},this.cmPlugin),this.mimeNode.setContent(t,'base64').setHeader(this.rootNodeHeaders),!0}catch(l){return!1}},d.prototype.checkSign=function(){var e,t=new ActiveXObject('CAPICOM.SignedData'),n=new ActiveXObject('CAPICOM.Utilities'),i=this.mailContent;try{return t.Verify(i,!1,0),i=h(n.BinaryToHex(t.Content)),this.parseMail(i),{name:(e=t.Signers.Item(1).Certificate).GetInfo(0),email:e.GetInfo(2)}}catch(a){return!1}},d.prototype.initCertificate=function(e){var t=new ActiveXObject('CAPICOM.Store'),n=new ActiveXObject('CAPICOM.Certificates');try{if(t.Open(2,'My',0),n=t.Certificates.Find(9).Find(6,6),null!=e&&''!=e){var a,r,s,c=new ActiveXObject('CAPICOM.Certificates');for(a=e.split(','),r=0;r<a.length;++r){var l=n.Find(1,a[r]);for(s=1;s<=l.Count;++s)c.Add(l.Item(s))}n=c}if(n.Count>1&&(n=n.Select(undefined,undefined,!1)),0==n.Count)return i.alert(o('mail/msg_filter_cert_fail')),!1}catch(d){if(-2138568446!=d.number)return i.alert(o('mail/ERRSTR_OPEN_CERT_STORE_ABORTING')+d.description),!1}return n.item(1)},d.prototype.dealWithAddResult=function(e,t){for(var n,i=this.cmPlugin.upload(),a=i.browser({single:!1}),r=[].concat(e),d=function(e){var t=0;return l.each(e,(function(e,n){t+=n.length})),t},u=0;u<a.length;u++){if(n=i.item(a[u]),d(r)+parseInt(n.size_str)>t)return alert(o('mail/FA_OVERFLOW.pref_smtp_max_send_mail_size')),e;r.push({id:r.length,fileName:c.basename(n.name),size:s.bytesToSize(n.size_str),length:parseInt(n.size_str),base64:n.base64ln(76),fileType:n.name.split('.').pop()})}return r},e.exports=d},809:function(e,t,n){var i=n(463),a=Math.PI,r=Math.pow,o=Math.sin,s={easeNone:function(e){return e},easeIn:function(e){return e*e},easeOut:function(e){return(2-e)*e},easeBoth:function(e){return(e*=2)<1?.5*e*e:.5*(1- --e*(e-2))},easeInStrong:function(e){return e*e*e*e},easeOutStrong:function(e){return 1- --e*e*e*e},easeBothStrong:function(e){return(e*=2)<1?.5*e*e*e*e:.5*(2-(e-=2)*e*e*e)},backIn:function(e){return 1===e&&(e-=.001),e*e*(2.70158*e-1.70158)},backOut:function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},backBoth:function(e){var t=1.70158,n=1+(t*=1.525);return(e*=2)<1?e*e*(n*e-t)*.5:.5*((e-=2)*e*(n*e+t)+2)},elasticIn:function(e){return 0===e||1===e?e:-r(2,10*(e-=1))*o(2*a*(e-.075)/.3)},elasticOut:function(e){return 0===e||1===e?e:r(2,-10*e)*o(2*a*(e-.075)/.3)+1},elasticBoth:function(e){var t=.45,n=t/4;return 0===e||2==(e*=2)?e:e<1?r(2,10*(e-=1))*o(2*a*(e-n)/t)*-.5:r(2,-10*(e-=1))*o(2*a*(e-n)/t)*.5+1},bounceIn:function(e){return 1-s.bounceOut(1-e)},bounceOut:function(e){var t=7.5625;return e<1/2.75?t*e*e:e<2/2.75?t*(e-=1.5/2.75)*e+.75:e<2.5/2.75?t*(e-=2.25/2.75)*e+.9375:t*(e-=2.625/2.75)*e+.984375},bounceBoth:function(e){return e<.5?.5*s.bounceIn(2*e):.5*s.bounceOut(2*e-1)+.5}};i.extend(i.easing,s),e.exports=s},810:function(e,t,n){var i=n(463)(window);e.exports={attrs:{autoplay:!1,interval:5e3},isNeeded:function(){return this.get('autoplay')},install:function(){var e,t=this.element,n='.'+this.cid,a=this.get('interval'),r=this;function o(){s(),r.paused=!1,e=setInterval((function(){r.paused||r.next()}),a)}function s(){e&&(clearInterval(e),e=null),r.paused=!0}o(),this.stop=s,this.start=o,this._scrollDetect=function(e,t){var n;function i(){i.stop(),n=setTimeout(e,t)}return t=t||200,i.stop=function(){n&&(clearTimeout(n),n=0)},i}((function(){r[function(e){var t=i.scrollTop(),n=t+i.height(),a=e.offset().top,r=a+e.height();return a<n&&r>t}(t)?'start':'stop']()})),i.on('scroll'+n,this._scrollDetect),this.element.hover(s,o)},destroy:function(){var e='.'+this.cid;this.stop&&this.stop(),this._scrollDetect&&(this._scrollDetect.stop(),i.off('scroll'+e))}}},811:function(e,t,n){var i=n(463),a=n(624).Effects;function r(e,t,n){var a=this.get('step'),r=this.get('length'),o=e?r-1:0,s=o*a,c=(o+1)*a,l=e?n:-n*r,d=e?-n*r:n*r,u=i(this.get('panels').get().slice(s,c));return u.css('position','relative'),u.css(t,d+'px'),l}function o(e,t,n){var a=this.get('step'),r=this.get('length'),o=e?r-1:0,s=o*a,c=(o+1)*a,l=i(this.get('panels').get().slice(s,c));l.css('position',''),l.css(t,''),this.content.css(t,e?-n*(r-1):'')}a.scrollCircular=function(e){var t=e.toIndex,n=e.fromIndex,i='scrollx'===this._scrollType,a=i?'left':'top',s=this.get('viewSize')[i?0:1],c=-s*t,l={};if(l[a]=c+'px',n>-1){this.anim&&this.anim.stop(!1,!0);var d=this.get('length'),u=0===n&&t===d-1,h=n===d-1&&0===t,m=this._isBackward===undefined?t<n:this._isBackward,f=m&&u||!m&&h;f&&(c=r.call(this,m,a,s),l[a]=c+'px');var p=this.get('duration'),g=this.get('easing'),v=this;this.anim=this.content.animate(l,p,g,(function(){v.anim=null,f&&o.call(v,m,a,s)}))}else this.content.css(l)},t.isNeeded=function(){var e=this.get('effect');return this.get('circular')&&('scrollx'===e||'scrolly'===e)},t.install=function(){this._scrollType=this.get('effect'),this.set('effect','scrollCircular')}},819:function(e,t,n){(function(t,i){var a=n(570),r=n(820),o=n(475);e.exports=function(e,n){var s=[];function c(e,n){e.off('mouseover.mwd').on('mouseover.mwd',(function(){var e=t(this);e.data('isRendered')||(e.data('isRendered',1),s.push(n(e)),e.mouseenter())}))}e._ContactCards=function(t,r){(n.supportPab||n.supportOab)&&c(t,(function(t){var n=t.attr('data-true-name'),s=o(null!=n?n:t.text(),t.attr('data-email')||t.attr('addr'));return new a(i.assign({parent:e,trigger:t,email:s},r))}))},e._memos=function(t,i){function a(t,n){var a=i.call?i(n):i;return t(n,a[0],a[1],e.pubsub)}if(n.enableMailMemo){var o=t.find('.j-memo-box');o[0]&&a(r,o),c(t.find('.j-memo-tip'),(function(e){return a(r.tip,e)}))}},e.before('destroy',(function(){e.toolbar&&e.toolbar.destroy(),s.forEach((function(e){e.destroy()})),s.length=0}))}}).call(this,n(463),n(464))},820:function(e,t,n){n(821);var i=n(822),a=i.tip,r=n(463),o=n(510),s=n(470).confirm,c=n(468).get,l=n(474),d=n(465),u=n(473);function h(e,t,n,h){var m,f=c('mail.maxMailMemo'),p=i();if(this===a)return m=new o({trigger:e,arrowPosition:11,inViewport:!0,theme:'yellow',distance:0,effect:'slide',content:a(p)}).after('render',(function(){var t=e.data('memoTip');e.data('memoTip',m),t&&t.destroy(),g(m.$())}));function g(i){var a=i.find('.memo-msg'),o=i.find('textarea').attr('maxlength',f);function c(){return o.val().length}function p(){var e=c();i.find('.j-memo-count').html(u.h(d('mail/mail_memo_word_count'),[e,f-e]))}function g(e){var i={memo:e};l.updateMailAttrs(t,i).then((function(){n=e,v(),h.pause(),l.flushMailAttrs(t,i),h.resume()}))}function v(t){a.text(n),o.val(n),p();var r=t||n;i.closest('.j-mail-memo').add(e).toggleClass('f-dn',!r),i.find('.j-memo-msg').toggle(!t),i.find('.j-memo-edit').toggle(!!t),r&&m&&m.show()}v(),i.find('.j-memo-op').click((function(){switch(r(this).data('action')){case'save':g(o.val());break;case'edit':v(!0);break;case'cancel':v();break;case'delete':s(d('mail/confirm_delete_mail_memo'),g.bind(0,''))}})),o.keydown((function(e){if(c()>=f&&8!==e.keyCode)return!1})).keyup(p)}g(e.html(p))}h.tip=h.bind(a),e.exports=h},822:function(e,t,n){e.exports=n(469)('<div class="memo-msg-content j-memo-msg"> <div class="memo-msg"></div> <div class="memo-op"> <a class="memo-op-a memo-edit j-memo-op" data-action="edit" href="javascript:void(0)">{{i18n "common/edit"}}</a> <a class="memo-op-a memo-delete j-memo-op" data-action="delete" href="javascript:void(0)">{{i18n "common/delete"}}</a> </div> </div> <div class="memo-edit-content j-memo-edit"> <div class="textarea-box"> <textarea name="memo-edit" rows="5"></textarea> </div> <div class="memo-op edit-foot"> <span class="j-memo-count f-fl"></span> <span class="u-btn u-btn-primary j-memo-op" data-action="save">{{i18n "common/save"}}</span> <span class="u-btn u-btn-default j-memo-op" data-action="cancel">{{i18n "common/cancel"}}</span> </div> </div>',{tip:'<div class="mail-memo-tip"> <h3 class="memo-title">{{i18n "mbox/mail_memo"}}</h3> {{{this}}} </div>'})},832:function(e,t,n){e.exports=function(t,n){t=t||self,n=t.document,function(i){'use strict';if(void 0!==t){var a,r,o,s,c,l,d,u=!0,h='',m=0,f='',p=null,g='',v=!1,b={resize:1,click:1},y=!0,_=1,w='bodyOffset',C=!0,N='',T={},x=32,M=null,S=!1,k='[iFrameSizer]',I=k.length,E='',O={max:1,min:1,bodyScroll:1,documentElementScroll:1},A='child',j=!0,R=t.parent,D='*',z=0,P=!1,F=null,H=16,L=1,B='scroll',W=t,V=function(){ie('MessageCallback function not defined')},U=function(){},q=function(){},X={height:function(){return ie('Custom height calculation function not defined'),n.documentElement.offsetHeight},width:function(){return ie('Custom width calculation function not defined'),n.body.scrollWidth}},$={},Q=Date.now||function(){return(new Date).getTime()},G={bodyOffset:function(){return n.body.offsetHeight+fe('marginTop')+fe('marginBottom')},offset:function(){return G.bodyOffset()},bodyScroll:function(){return n.body.scrollHeight},custom:function(){return X.height()},documentElementOffset:function(){return n.documentElement.offsetHeight},documentElementScroll:function(){return n.documentElement.scrollHeight},max:function(){return Math.max.apply(null,ge(G))},min:function(){return Math.min.apply(null,ge(G))},grow:function(){return G.max()},lowestElement:function(){return Math.max(G.bodyOffset()||G.documentElementOffset(),pe('bottom',be()))},taggedElement:function(){return ve('bottom','data-iframe-height')}},K={bodyScroll:function(){return n.body.scrollWidth},bodyOffset:function(){return n.body.offsetWidth},custom:function(){return X.width()},documentElementScroll:function(){return n.documentElement.scrollWidth},documentElementOffset:function(){return n.documentElement.offsetWidth},scroll:function(){return Math.max(K.bodyScroll(),K.documentElementScroll())},max:function(){return Math.max.apply(null,ge(K))},min:function(){return Math.min.apply(null,ge(K))},rightMostElement:function(){return pe('right',be())},taggedElement:function(){return ve('right','data-iframe-width')}},Y=(a=ye,c=null,l=0,d=function(){l=Q(),c=null,s=a.apply(r,o),c||(r=o=null)},function(){var e=Q();l||(l=e);var t=H-(e-l);return r=this,o=arguments,t<=0||t>H?(c&&(clearTimeout(c),c=null),l=e,s=a.apply(r,o),c||(r=o=null)):c||(c=setTimeout(d,t)),s});J(t,'message',xe),'loading'!==n.readyState&&t.parent.postMessage('[iFrameResizerChild]Ready','*')}function J(e,n,i){'addEventListener'in t?e.addEventListener(n,i,!1):'attachEvent'in t&&e.attachEvent('on'+n,i)}function Z(e,n,i){'removeEventListener'in t?e.removeEventListener(n,i,!1):'detachEvent'in t&&e.detachEvent('on'+n,i)}function ee(e){return e.charAt(0).toUpperCase()+e.slice(1)}function te(e){return k+'['+E+'] '+e}function ne(e){S&&'object'==typeof t.console&&console.log(te(e))}function ie(e){'object'==typeof t.console&&console.warn(te(e))}function ae(){var e;!function(){function e(e){return'true'===e}var t=N.substr(I).split(':');E=t[0],m=void 0!==t[1]?Number(t[1]):m,v=void 0!==t[2]?e(t[2]):v,S=void 0!==t[3]?e(t[3]):S,x=void 0!==t[4]?Number(t[4]):x,u=void 0!==t[6]?e(t[6]):u,f=t[7],w=void 0!==t[8]?t[8]:w,h=t[9],g=t[10],z=void 0!==t[11]?Number(t[11]):z,T.enable=void 0!==t[12]&&e(t[12]),A=void 0!==t[13]?t[13]:A,B=void 0!==t[14]?t[14]:B}(),ne('Initialising iFrame ('+location.href+')'),function(){function e(e,t){return'function'==typeof e&&(ne('Setup custom '+t+'CalcMethod'),X[t]=e,e='custom'),e}'iFrameResizer'in t&&Object===t.iFrameResizer.constructor&&(n=t.iFrameResizer,ne('Reading data from page: '+JSON.stringify(n)),V='messageCallback'in n?n.messageCallback:V,U='readyCallback'in n?n.readyCallback:U,D='targetOrigin'in n?n.targetOrigin:D,w='heightCalculationMethod'in n?n.heightCalculationMethod:w,B='widthCalculationMethod'in n?n.widthCalculationMethod:B,w=e(w,'height'),B=e(B,'width'));var n;ne('TargetOrigin for parent set to: '+D)}(),function(){void 0===f&&(f=m+'px');re('margin',function(e,t){-1!==t.indexOf('-')&&(ie('Negative CSS value ignored for '+e),t='');return t}('margin',f))}(),re('background',h),re('padding',g),(e=n.createElement('div')).style.clear='both',e.style.display='block',n.body.appendChild(e),le(),de(),n.documentElement.style.height='',n.body.style.height='',ne('HTML & body height set to "auto"'),ne('Enable public methods'),W.parentIFrame={autoResize:function(e){return!0===e&&!1===u?(u=!0,ue()):!1===e&&!0===u&&(u=!1,he()),u},close:function(){Te(0,0,'close'),ne('Disable outgoing messages'),j=!1,ne('Remove event listener: Message'),Z(t,'message',xe),!0===u&&he()},getId:function(){return E},getPageInfo:function(e){'function'==typeof e?(q=e,Te(0,0,'pageInfo')):(q=function(){},Te(0,0,'pageInfoStop'))},moveToAnchor:function(e){T.findTarget(e)},reset:function(){Ne('parentIFrame.reset')},scrollTo:function(e,t){Te(t,e,'scrollTo')},scrollToOffset:function(e,t){Te(t,e,'scrollToOffset')},sendMessage:function(e,t){Te(0,0,'message',JSON.stringify(e),t)},setHeightCalculationMethod:function(e){w=e,le()},setWidthCalculationMethod:function(e){B=e,de()},setTargetOrigin:function(e){ne('Set targetOrigin: '+e),D=e},size:function(e,t){_e('size','parentIFrame.size('+(e||'')+(t?','+t:'')+')',e,t)}},ue(),T=function(){function e(e){var i=e.getBoundingClientRect(),a={x:void 0!==t.pageXOffset?t.pageXOffset:n.documentElement.scrollLeft,y:void 0!==t.pageYOffset?t.pageYOffset:n.documentElement.scrollTop};return{x:parseInt(i.left,10)+parseInt(a.x,10),y:parseInt(i.top,10)+parseInt(a.y,10)}}function i(t){var i=t.split('#')[1]||t,a=decodeURIComponent(i),r=n.getElementById(a)||n.getElementsByName(a)[0];void 0!==r?function(t){var n=e(t);ne('Moving to in page link (#'+i+') at x: '+n.x+' y: '+n.y),Te(n.y,n.x,'scrollToOffset')}(r):(ne('In page link (#'+i+') not found in iFrame, so sending to parent'),Te(0,0,'inPageLink','#'+i))}function a(){''!==location.hash&&'#'!==location.hash&&i(location.href)}T.enable?Array.prototype.forEach&&n.querySelectorAll?(ne('Setting up location.hash handlers'),Array.prototype.forEach.call(n.querySelectorAll('a[href^="#"]'),(function(e){'#'!==e.getAttribute('href')&&J(e,'click',(function(e){e.preventDefault(),i(this.getAttribute('href'))}))})),J(t,'hashchange',a),setTimeout(a,128)):ie('In page linking not fully supported in this browser! (See README.md for IE8 workaround)'):ne('In page linking not enabled');return{findTarget:i}}(),_e('init','Init message from host page'),U()}function re(e,t){void 0!==t&&''!==t&&'null'!==t&&(n.body.style[e]=t,ne('Body '+e+' set to "'+t+'"'))}function oe(e){var n={add:function(n){function i(){_e(e.eventName,e.eventType)}$[n]=i,J(t,n,i)},remove:function(e){var n=$[e];delete $[e],Z(t,e,n)}};e.eventNames&&Array.prototype.map?(e.eventName=e.eventNames[0],e.eventNames.map(n[e.method])):n[e.method](e.eventName),ne(ee(e.method)+' event listener: '+e.eventType)}function se(e){oe({method:e,eventType:'Animation Start',eventNames:['animationstart','webkitAnimationStart']}),oe({method:e,eventType:'Animation Iteration',eventNames:['animationiteration','webkitAnimationIteration']}),oe({method:e,eventType:'Animation End',eventNames:['animationend','webkitAnimationEnd']}),oe({method:e,eventType:'Input',eventName:'input'}),oe({method:e,eventType:'Mouse Up',eventName:'mouseup'}),oe({method:e,eventType:'Mouse Down',eventName:'mousedown'}),oe({method:e,eventType:'Orientation Change',eventName:'orientationchange'}),oe({method:e,eventType:'Print',eventName:['afterprint','beforeprint']}),oe({method:e,eventType:'Ready State Change',eventName:'readystatechange'}),oe({method:e,eventType:'Touch Start',eventName:'touchstart'}),oe({method:e,eventType:'Touch End',eventName:'touchend'}),oe({method:e,eventType:'Touch Cancel',eventName:'touchcancel'}),oe({method:e,eventType:'Transition Start',eventNames:['transitionstart','webkitTransitionStart','MSTransitionStart','oTransitionStart','otransitionstart']}),oe({method:e,eventType:'Transition Iteration',eventNames:['transitioniteration','webkitTransitionIteration','MSTransitionIteration','oTransitionIteration','otransitioniteration']}),oe({method:e,eventType:'Transition End',eventNames:['transitionend','webkitTransitionEnd','MSTransitionEnd','oTransitionEnd','otransitionend']}),'child'===A&&oe({method:e,eventType:'IFrame Resized',eventName:'resize'})}function ce(e,t,n,i){return t!==e&&(e in n||(ie(e+' is not a valid option for '+i+'CalculationMethod.'),e=t),ne(i+' calculation method set to "'+e+'"')),e}function le(){w=ce(w,'bodyOffset',G,'height')}function de(){B=ce(B,'scroll',K,'width')}function ue(){var e;!0===u?(se('add'),e=0>x,t.MutationObserver||t.WebKitMutationObserver?e?me():p=function(){function e(e){function t(e){!1===e.complete&&(ne('Attach listeners to '+e.src),e.addEventListener('load',r,!1),e.addEventListener('error',o,!1),c.push(e))}'attributes'===e.type&&'src'===e.attributeName?t(e.target):'childList'===e.type&&Array.prototype.forEach.call(e.target.querySelectorAll('img'),t)}function i(e){ne('Remove listeners from '+e.src),e.removeEventListener('load',r,!1),e.removeEventListener('error',o,!1),function(e){c.splice(c.indexOf(e),1)}(e)}function a(e,t,n){i(e.target),_e(t,n+': '+e.target.src,void 0,void 0)}function r(e){a(e,'imageLoad','Image loaded')}function o(e){a(e,'imageLoadFailed','Image load failed')}function s(t){_e('mutationObserver','mutationObserver: '+t[0].target+' '+t[0].type),t.forEach(e)}var c=[],l=t.MutationObserver||t.WebKitMutationObserver,d=function(){var e=n.querySelector('body');return d=new l(s),ne('Create body MutationObserver'),d.observe(e,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}),d}();return{disconnect:function(){'disconnect'in d&&(ne('Disconnect body MutationObserver'),d.disconnect(),c.forEach(i))}}}():(ne('MutationObserver not supported in this browser!'),me())):ne('Auto Resize disabled')}function he(){se('remove'),null!==p&&p.disconnect(),clearInterval(M)}function me(){0!==x&&(ne('setInterval: '+x+'ms'),M=setInterval((function(){_e('interval','setInterval: '+x)}),Math.abs(x)))}function fe(e,t){var i=0;return t=t||n.body,i='defaultView'in n&&'getComputedStyle'in n.defaultView?null!==(i=n.defaultView.getComputedStyle(t,null))?i[e]:0:function(e){if(/^\d+(px)?$/i.test(e))return parseInt(e,10);var n=t.style.left,i=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft,t.style.left=n,t.runtimeStyle.left=i,e}(t.currentStyle[e]),parseInt(i,10)}function pe(e,t){for(var n=t.length,i=0,a=0,r=ee(e),o=Q(),s=0;s<n;s++)(i=t[s].getBoundingClientRect()[e]+fe('margin'+r,t[s]))>a&&(a=i);return o=Q()-o,ne('Parsed '+n+' HTML elements'),ne('Element position calculated in '+o+'ms'),function(e){e>H/2&&ne('Event throttle increased to '+(H=2*e)+'ms')}(o),a}function ge(e){return[e.bodyOffset(),e.bodyScroll(),e.documentElementOffset(),e.documentElementScroll()]}function ve(e,t){var i=n.querySelectorAll('['+t+']');return 0===i.length&&(ie('No tagged elements ('+t+') found on page'),n.querySelectorAll('body *')),pe(e,i)}function be(){return n.querySelectorAll('body *')}function ye(e,t,n,i){var a,r;!function(){function e(e,t){return!(Math.abs(e-t)<=z)}return a=void 0!==n?n:G[w](),r=void 0!==i?i:K[B](),e(_,a)||v&&e(L,r)}()&&'init'!==e?!(e in{init:1,interval:1,size:1})&&(w in O||v&&B in O)?Ne(t):e in{interval:1}||ne('No change in size detected'):(we(),Te(_=a,L=r,e))}function _e(e,t,n,i){P&&e in b?ne('Trigger event cancelled: '+e):(e in{reset:1,resetPage:1,init:1}||ne('Trigger event: '+t),'init'===e?ye(e,t,n,i):Y(e,t,n,i))}function we(){P||(P=!0,ne('Trigger event lock on')),clearTimeout(F),F=setTimeout((function(){P=!1,ne('Trigger event lock off'),ne('--')}),128)}function Ce(e){_=G[w](),L=K[B](),Te(_,L,e)}function Ne(e){var t=w;w='bodyOffset',ne('Reset trigger event: '+e),we(),Ce('reset'),w=t}function Te(e,t,n,i,a){var r;!0===j&&(void 0===a?a=D:ne('Message targetOrigin: '+a),ne('Sending message to host page ('+(r=E+':'+e+':'+t+':'+n+(void 0!==i?':'+i:''))+')'),R.postMessage(k+r,a))}function xe(i){var a={init:function(){'interactive'===n.readyState||'complete'===n.readyState?(N=i.data,R=i.source,ae(),y=!1,setTimeout((function(){C=!1}),128)):(ne('Waiting for page ready'),J(t,'readystatechange',a.initFromParent))},reset:function(){C?ne('Page reset ignored by init'):(ne('Page size reset by host page'),Ce('resetPage'))},resize:function(){_e('resizeParent','Parent window requested size check')},moveToAnchor:function(){T.findTarget(o())},inPageLink:function(){this.moveToAnchor()},pageInfo:function(){var e=o();ne('PageInfoFromParent called from parent: '+e),q(JSON.parse(e)),ne(' --')},message:function(){var e=o();ne('MessageCallback called from parent: '+e),V(JSON.parse(e)),ne(' --')}};function r(){return i.data.split(']')[1].split(':')[0]}function o(){return i.data.substr(i.data.indexOf(':')+1)}function s(){return i.data.split(':')[2]in{'true':1,'false':1}}function c(){var n=r();n in a?a[n]():!e.exports&&'iFrameResize'in t||s()||ie('Unexpected message ('+i.data+')')}k===(''+i.data).substr(0,I)&&(!1===y?c():s()?a.init():ne('Ignored message of type "'+r()+'". Received before initialization.'))}}()}},833:function(e,t,n){'use strict';n.r(t),function(e){function i(t,i){t.iFrameResize(e.assign({inPageLinks:!0,checkOrigin:!1,widthCalculationMethod:'rightMostElement',heightCalculationMethod:n(481).LE10?'max':'lowestElement',resizeFrom:'child'},i))}n.d(t,'resize',(function(){return i})),n(834)}.call(this,n(464))},834:function(e,t,n){(function(n){var i,a,r;!function(o){'use strict';if('undefined'!=typeof window){var s,c=0,l=!1,d=!1,u='message'.length,h='[iFrameSizer]',m=h.length,f=null,p=window.requestAnimationFrame,g={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},v={},b=null,y={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:'bodyOffset',id:'iFrameResizer',interval:32,log:!1,maxHeight:Infinity,maxWidth:Infinity,minHeight:0,minWidth:0,resizeFrom:'parent',scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:'scroll',closedCallback:function(){},initCallback:function(){},messageCallback:function(){S('MessageCallback function not defined')},resizedCallback:function(){},scrollCallback:function(){return!0}},_={};n&&((s=n).fn?s.fn.iFrameResize||(s.fn.iFrameResize=function(e){return this.filter('iframe').each((function(t,n){L(n,e)})).end()}):M('','Unable to bind to jQuery, it is not fully loaded.')),a=[],void 0===(r='function'==typeof(i=function(){function e(e,n){n&&(!function(){if(!n.tagName)throw new TypeError('Object is not a valid DOM element');if('IFRAME'!==n.tagName.toUpperCase())throw new TypeError('Expected <IFRAME> tag, found <'+n.tagName+'>')}(),L(n,e),t.push(n))}var t;return function(){var e,t=['moz','webkit','o','ms'];for(e=0;e<t.length&&!p;e+=1)p=window[t[e]+'RequestAnimationFrame'];p||x('setup','RequestAnimationFrame not supported')}(),w(window,'message',I),w(window,'resize',(function(){W('resize')})),w(document,'visibilitychange',V),w(document,'-webkit-visibilitychange',V),w(window,'focusin',(function(){W('focus')})),w(window,'focus',(function(){W('focus')})),function(n,i){switch(t=[],function(e){e&&e.enablePublicMethods&&S('enablePublicMethods option has been removed, public methods are now always available in the iFrame')}(n),typeof i){case'undefined':case'string':Array.prototype.forEach.call(document.querySelectorAll(i||'iframe'),e.bind(void 0,n));break;case'object':e(n,i);break;default:throw new TypeError('Unexpected data type ('+typeof i+')')}return t}})?i.apply(t,a):i)||(e.exports=r)}function w(e,t,n){'addEventListener'in window?e.addEventListener(t,n,!1):'attachEvent'in window&&e.attachEvent('on'+t,n)}function C(e,t,n){'removeEventListener'in window?e.removeEventListener(t,n,!1):'detachEvent'in window&&e.detachEvent('on'+t,n)}function N(e){return h+'['+function(e){var t='Host page: '+e;return window.top!==window.self&&(t=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+': '+e:'Nested host page: '+e),t}(e)+']'}function T(e){return v[e]?v[e].log:l}function x(e,t){k('log',e,t,T(e))}function M(e,t){k('info',e,t,T(e))}function S(e,t){k('warn',e,t,!0)}function k(e,t,n,i){!0===i&&'object'==typeof window.console&&console[e](N(t),n)}function I(e){function t(){n('Height'),n('Width'),P((function(){z(b),j(y),c('resizedCallback',b)}),b,'init')}function n(e){var t=Number(v[y]['max'+e]),n=Number(v[y]['min'+e]),i=e.toLowerCase(),a=Number(b[i]);x(y,'Checking '+i+' is in range '+n+'-'+t),a<n&&(a=n,x(y,'Set '+i+' to min value')),a>t&&(a=t,x(y,'Set '+i+' to max value')),b[i]=''+a}function i(e){return g.substr(g.indexOf(':')+u+e)}function a(e,t){var n,i,a;n=function(){var n,i;F('Send Page Info','pageInfo:'+(n=document.body.getBoundingClientRect(),i=b.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:i.height,iframeWidth:i.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(i.top-n.top,10),offsetLeft:parseInt(i.left-n.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})),e,t)},i=32,_[a=t]||(_[a]=setTimeout((function(){_[a]=null,n()}),i))}function r(e){var t=e.getBoundingClientRect();return A(y),{x:Math.floor(Number(t.left)+Number(f.x)),y:Math.floor(Number(t.top)+Number(f.y))}}function o(e){var t=e?r(b.iframe):{x:0,y:0},n={x:Number(b.width)+t.x,y:Number(b.height)+t.y};x(y,'Reposition requested from iFrame (offset x:'+t.x+' y:'+t.y+')'),window.top!==window.self?window.parentIFrame?window.parentIFrame['scrollTo'+(e?'Offset':'')](n.x,n.y):S(y,'Unable to scroll to requested position, window.parentIFrame not found'):(f=n,s(),x(y,'--'))}function s(){!1!==c('scrollCallback',f)?j(y):R()}function c(e,t){return E(y,e,t)}var l,d,p,g=e.data,b={},y=null;'[iFrameResizerChild]Ready'===g?function(){for(var e in v)F('iFrame requested init',H(e),document.getElementById(e),e)}():h===(''+g).substr(0,m)&&g.substr(m).split(':')[0]in v?(p=g.substr(m).split(':'),b={iframe:v[p[0]]&&v[p[0]].iframe,id:p[0],height:p[1],width:p[2],type:p[3]},y=b.id,v[y]&&(v[y].loaded=!0),(d=b.type in{'true':1,'false':1,undefined:1})&&x(y,'Ignoring init message from meta parent page'),!d&&function(e){var t=!0;return v[e]||(t=!1,S(b.type+' No settings for '+e+'. Message was: '+g)),t}(y)&&(x(y,'Received: '+g),l=!0,null===b.iframe&&(S(y,'IFrame ('+b.id+') not found'),l=!1),l&&function(){var t,n=e.origin,i=v[y]&&v[y].checkOrigin;if(i&&''+n!='null'&&!(i.constructor===Array?function(){var e=0,t=!1;for(x(y,'Checking connection is from allowed list of origins: '+i);e<i.length;e++)if(i[e]===n){t=!0;break}return t}():(t=v[y]&&v[y].remoteHost,x(y,'Checking connection is from: '+t),n===t)))throw new Error('Unexpected message received from: '+n+' for '+b.iframe.id+'. Message was: '+e.data+'. This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.');return!0}()&&function(){switch(v[y]&&v[y].firstRun&&v[y]&&(v[y].firstRun=!1),b.type){case'close':v[y].closeRequestCallback?E(y,'closeRequestCallback',v[y].iframe):O(b.iframe);break;case'message':e=i(6),x(y,'MessageCallback passed: {iframe: '+b.iframe.id+', message: '+e+'}'),c('messageCallback',{iframe:b.iframe,message:JSON.parse(e)}),x(y,'--');break;case'scrollTo':o(!1);break;case'scrollToOffset':o(!0);break;case'pageInfo':a(v[y]&&v[y].iframe,y),function(){function e(e,i){function r(){v[n]?a(v[n].iframe,n):t()}['scroll','resize'].forEach((function(t){x(n,e+t+' listener for sendPageInfo'),i(window,t,r)}))}function t(){e('Remove ',C)}var n=y;e('Add ',w),v[n]&&(v[n].stopPageInfo=t)}();break;case'pageInfoStop':v[y]&&v[y].stopPageInfo&&(v[y].stopPageInfo(),delete v[y].stopPageInfo);break;case'inPageLink':!function(e){var t,n=e.split('#')[1]||'',i=decodeURIComponent(n),a=document.getElementById(i)||document.getElementsByName(i)[0];a?(t=r(a),x(y,'Moving to in page link (#'+n+') at x: '+t.x+' y: '+t.y),f={x:t.x,y:t.y},s(),x(y,'--')):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(n):x(y,'In page link #'+n+' not found and window.parentIFrame not found'):x(y,'In page link #'+n+' not found')}(i(9));break;case'reset':D(b);break;case'init':t(),c('initCallback',b.iframe);break;default:t()}var e}())):M(y,'Ignored: '+g)}function E(e,t,n){var i=null,a=null;if(v[e]){if('function'!=typeof(i=v[e][t]))throw new TypeError(t+' on iFrame['+e+'] is not a function');a=i(n)}return a}function O(e){var t=e.id;x(t,'Removing iFrame: '+t),e.parentNode&&e.parentNode.removeChild(e),E(t,'closedCallback',t),x(t,'--'),delete v[t]}function A(e){null===f&&x(e,'Get page position: '+(f={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop}).x+','+f.y)}function j(e){null!==f&&(window.scrollTo(f.x,f.y),x(e,'Set page position: '+f.x+','+f.y),R())}function R(){f=null}function D(e){x(e.id,'Size reset requested by '+('init'===e.type?'host page':'iFrame')),A(e.id),P((function(){z(e),F('reset','reset',e.iframe,e.id)}),e,'reset')}function z(e){function t(t){d||'0'!==e[t]||(d=!0,x(i,'Hidden iFrame detected, creating visibility listener'),function(){function e(){function e(e){function t(t){return'0px'===(v[e]&&v[e].iframe.style[t])}v[e]&&null!==v[e].iframe.offsetParent&&(t('height')||t('width'))&&F('Visibility change','resize',v[e].iframe,e)}for(var t in v)e(t)}function t(t){x('window','Mutation observed: '+t[0].target+' '+t[0].type),B(e,16)}var n=window.MutationObserver||window.WebKitMutationObserver;n&&(i=document.querySelector('body'),new n(t).observe(i,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}));var i}())}function n(n){!function(t){e.iframe.style[t]=e[t]+'px',x(e.id,'IFrame ('+i+') '+t+' set to '+e[t]+'px')}(n),t(n)}var i=e.iframe.id;v[i]&&(v[i].sizeHeight&&n('height'),v[i].sizeWidth&&n('width'))}function P(e,t,n){n!==t.type&&p?(x(t.id,'Requesting animation frame'),p(e)):e()}function F(e,t,n,i,a){var r,o=!1;i=i||n.id,v[i]&&(n&&'contentWindow'in n&&null!==n.contentWindow?(r=v[i]&&v[i].targetOrigin,x(i,'['+e+'] Sending msg to iframe['+i+'] ('+t+') targetOrigin: '+r),n.contentWindow.postMessage(h+t,r)):S(i,'['+e+'] IFrame('+i+') not found'),a&&v[i]&&v[i].warningTimeout&&(v[i].msgTimeout=setTimeout((function(){!v[i]||v[i].loaded||o||(o=!0,S(i,'IFrame has not responded within '+v[i].warningTimeout/1e3+' seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning.'))}),v[i].warningTimeout)))}function H(e){return e+':'+v[e].bodyMarginV1+':'+v[e].sizeWidth+':'+v[e].log+':'+v[e].interval+':'+v[e].enablePublicMethods+':'+v[e].autoResize+':'+v[e].bodyMargin+':'+v[e].heightCalculationMethod+':'+v[e].bodyBackground+':'+v[e].bodyPadding+':'+v[e].tolerance+':'+v[e].inPageLinks+':'+v[e].resizeFrom+':'+v[e].widthCalculationMethod}function L(e,t){var n,i=function(n){var i;return n,''===n&&(e.id=(i=t&&t.id||y.id+c++,null!==document.getElementById(i)&&(i+=c++),n=i),l=(t||{}).log,n,x(n,'Added missing iframe ID: '+n+' ('+e.src+')')),n}(e.id);i in v&&'iFrameResizer'in e?S(i,'Ignored iFrame, already setup.'):(!function(t){var n;t=t||{},v[i]={firstRun:!0,iframe:e,remoteHost:e.src.split('/').slice(0,3).join('/')},function(e){if('object'!=typeof e)throw new TypeError('Options is not an object')}(t),function(e){for(var t in y)y.hasOwnProperty(t)&&(v[i][t]=e.hasOwnProperty(t)?e[t]:y[t])}(t),v[i]&&(v[i].targetOrigin=!0===v[i].checkOrigin?''===(n=v[i].remoteHost)||'file://'===n?'*':n:'*')}(t),function(){switch(x(i,'IFrame scrolling '+(v[i]&&v[i].scrolling?'enabled':'disabled')+' for '+i),e.style.overflow=!1===(v[i]&&v[i].scrolling)?'hidden':'auto',v[i]&&v[i].scrolling){case!0:e.scrolling='yes';break;case!1:e.scrolling='no';break;default:e.scrolling=v[i]?v[i].scrolling:'no'}}(),function(){function t(t){Infinity!==v[i][t]&&0!==v[i][t]&&(e.style[t]=v[i][t]+'px',x(i,'Set '+t+' = '+v[i][t]+'px'))}function n(e){if(v[i]['min'+e]>v[i]['max'+e])throw new Error('Value for min'+e+' can not be greater than max'+e)}n('Height'),n('Width'),t('maxHeight'),t('minHeight'),t('maxWidth'),t('minWidth')}(),'number'!=typeof(v[i]&&v[i].bodyMargin)&&'0'!==(v[i]&&v[i].bodyMargin)||(v[i].bodyMarginV1=v[i].bodyMargin,v[i].bodyMargin=v[i].bodyMargin+'px'),n=H(i),w(e,'load',(function(){var t,a;F('iFrame.onload',n,e,void 0,!0),t=v[i]&&v[i].firstRun,a=v[i]&&v[i].heightCalculationMethod in g,!t&&a&&D({iframe:e,height:0,width:0,type:'init'})})),F('init',n,e,void 0,!0),Function.prototype.bind&&v[i]&&(v[i].iframe.iFrameResizer={close:O.bind(null,v[i].iframe),resize:F.bind(null,'Window resize','resize',v[i].iframe),moveToAnchor:function(e){F('Move to anchor','moveToAnchor:'+e,v[i].iframe,i)},sendMessage:function(e){F('Send Message','message:'+(e=JSON.stringify(e)),v[i].iframe,i)}}))}function B(e,t){null===b&&(b=setTimeout((function(){b=null,e()}),t))}function W(e){x('window','Trigger event: '+e),B((function(){U('Window '+e,'resize')}),16)}function V(){'hidden'!==document.visibilityState&&(x('document','Trigger event: Visiblity change'),B((function(){U('Tab Visable','resize')}),16))}function U(e,t){function n(e){return v[e]&&'parent'===v[e].resizeFrom&&v[e].autoResize&&!v[e].firstRun}for(var i in v)n(i)&&F(e,t,document.getElementById(i),i)}}()}).call(this,n(463))},835:function(e,t,n){(function(t){n(836);var i=n(837),a=n(470).confirm;e.exports=function(e){a(i({url:e}),{width:550,confirmTpl:t('mail/op_sspurl_continue'),afterShow:function(){var e=this.$('.more .link').click((function(){e.find('.arrow').toggleClass('arrow-down arrow-up'),e.next('.detail').slideToggle()}))},onConfirm:function(){window.open(e)}})}}).call(this,n(465))},837:function(e,t,n){e.exports=n(469)('<div class="sspurl-container"> <h3>{{i18n \'mail/msg_sspurl_tips\'}}</h3> <p>{{url}}</p> <p class="tip">{{i18n \'mail/msg_sspurl_advice\'}}</p> <div class="more"> <a href="javascript:void(0)" class="link"> {{i18n \'mail/op_sspurl_toggle\'}}<span class="arrow arrow-down"/> </a> <div class="detail"> {{i18n \'mail/msg_sspurl_detail\'}}</div> </div> </div>',{})},838:function(e,t,n){(function(t,i){n(839);var a=n(468).get,r=n(465),o=n(840);e.exports=function(e,s,c){var l='hideBtn',d='';e.next('.j-translation-box').remove();var u=t(o({original:s,originals:a('user.originalLanguages').map((function(e){return{lang:e,text:r('pref/translate/translate_'+e)}})),target:c,targets:a('user.targetLanguages').map((function(e){return{lang:e,text:r('pref/translate/translate_'+e)}}))}));return e.after(u),u.click((function(e){var i=t(e.target).data('action');switch(i){case'showContent':case'hideContent':m(i);break;case'toggleSelect':u.find('.j-translation-language-content').toggleClass('f-dn'),u.find('.j-translation-language-select').toggleClass('toggle-select');break;case'goSetting':n(477).go('setting.advance.translate')}})),u.find('.j-translation-language-content > select').change((function(){var e=t(this).attr('name'),n=t(this).val();'original'===e?(s=n,h()):'target'===e&&(c=n,h())})),function(t,n){var i,a,r;'showBtn'===l?m('hideBtn'):'showContent'===l?m('hideContent'):!t||'hideBtn'!==l&&'hideContent'!==l||(d=t,m('showBtn'),i=n,a=+e.parent().css('padding-top').replace('px',''),r=+e.parent().css('padding-left').replace('px',''),u.css({top:i.clientY+a+5+'px',left:i.clientX+r+5+'px'}))};function h(e){i.wmCall({url:'/common/ext/translate.jsp'},{word:d,from:s,to:c}).then((function(t){var n,i;0===t.err_no?(n=d.length<26?d:r('pref/translate/result'),i=t.out||d):(n=r('pref/translate/errorTitle'),i=-101===t.error_code?r('pref/translate/too_long'):10002===t.error_code||10005===t.error_code?r('pref/translate/contains_illegal_char'):r('pref/translate/request_fail_try_again')),u.find('.j-translation-title').html(n),u.find('.j-translation-body').html(i),e&&u.find('.j-translation-content').fadeIn(500)}))}function m(e){l=e,'showContent'===e?(u.find('.j-translation-show-btn').fadeOut(300),h(!0)):'hideContent'===e?u.find('.j-translation-content').fadeOut(300,(function(){u.find('.j-translation-language-content').hasClass('f-dn')||u.find('.j-translation-language-select').trigger('click')})):'showBtn'===e?u.find('.j-translation-show-btn').fadeIn(300):'hideBtn'===e&&u.find('.j-translation-show-btn').fadeOut(300)}}}).call(this,n(463),n(466))},840:function(e,t,n){e.exports=n(469)('<div class="u-translation-box j-translation-box"> <span class="u-translation-show-btn j-translation-show-btn f-dn" data-action="showContent">{{i18n \'pref/translate/translate_action\'}}</span> <div class="u-translation-content j-translation-content f-dn"> <div class="u-translation-head"> <span class="u-translation-title j-translation-title"></span> <div class="u-translation-head-right"> <div class="u-translation-language-select j-translation-language-select" data-action="toggleSelect"> <span data-action="toggleSelect">{{i18n \'pref/translate/language_select\'}}</span> <i class="iconfont icondown" data-action="toggleSelect"></i> <i class="iconfont iconup" data-action="toggleSelect"></i> </div> <i class="iconfont icontabclose u-translation-close-btn" data-action="hideContent"></i> </div> </div> <div class="u-translation-language-content j-translation-language-content f-dn"> <select name="original"> {{#each originals}}\' <option value="{{lang}}" {{if$ (eq lang ../original) \'selected\'}}>{{text}}</option> {{/each}}\' </select> <i class="iconfont iconxtnext"></i> <select name="target"> {{#each targets}}\' <option value="{{lang}}" {{if$ (eq lang ../target) \'selected\'}}>{{text}}</option> {{/each}}\' </select> </div> <div class="u-translation-body j-translation-body"></div> <div class="u-translation-foot"> <div class="u-translation-foot-left"> <span class="king-soft-icon" title="{{i18n \'pref/translate/come_from\'}}"></span> <a href="http://www.kingsoft.com" target="_blank">www.kingsoft.com</a> </div> <div class="u-translation-foot-right"> <i class="iconfont iconset u-translation-setting-btn" data-action="goSetting"></i> </div> </div> </div> </div>',{})},844:function(e,t,n){e.exports=n(469)('{{>tabs}} <div class="attach-content"> {{#if attachments}} <div class="j-tab-panels"> {{#if trsAttachments}} <div class="attachments-op"> {{#if (gt attachments.length 1)}} {{#if packUrl}} <a href="{{packUrl}}">{{i18n "mbox/pack_mail"}}</a> {{/if}} {{#if attachments.0.nf}} <a class="f-csp j-saveToNetFolder">{{i18n "mbox/add_to_netfolder"}}</a> {{/if}} {{/if}} </div> {{/if}} {{#each attachments}} <div class=attachment>{{>attachmentTpl}}</div> {{/each}} </div> {{/if}} {{#if trsAttachments}} <div class="j-tab-panels {{#if attachments}}f-dn{{/if}}"> {{#each trsAttachments}} <div class=trs-attachment>{{>attachmentTpl}}</div> {{/each}} </div> {{/if}} </div>',{attachmentTpl:'<div class="attach-type"> <span class="file-icon icon-{{fileType}}"></span> </div> <div class="attach-info {{if$ actions \'\' \'not-actions\'}}"> <div class="attach-name" title="{{filename}}">{{filename}}</div> {{#if formatSize}} <div class="attach-size">({{formatSize}})</div> {{/if}} {{#if attachExpiryTime}} <div class="attach-expiration-time">({{attachExpiryTime}})</div> {{/if}} <div class=attach-actions>{{>attachActionTpl}}</div> </div>',attachActionTpl:'<ul class=action-list data-id="{{id}}"> {{#if download}} <li class=action-item> <a rel=download href="{{download.url}}" target="_blank">{{i18n "common/op_download"}}</a> </li> {{/if}} {{#if open}} <li class=action-item> <a rel=open href="{{openUrl}}" target=_blank>{{i18n "common/op_open"}}</a> </li> {{/if}} {{#if preview}} <li class=action-item> <a rel=preview href="{{preview.url}}" target=_blank>{{i18n "common/preview"}}</a> </li> {{/if}} {{#if nf}} <li class=action-item> <a rel=nf class=f-csp>{{i18n "common/op_to_netfolder"}}</a> </li> {{/if}} {{#if xnf}} <li class=action-item> <a rel=xnf class=f-csp>{{i18n "prop:common/op_to_xnffolder" 0=xnf.name}}</a> </li> {{/if}} </ul>',tabs:'{{#if attachments}}{{#if trsAttachments}} <div class="u-tab j-tab-wrap"> <ul class="attach-nav"> <li class="j-tab-trigger z-current"><a href="javascript:void(0)">{{i18n "mbox/mail_normalatt"}}({{attachments.length}} {{i18n "mail/attachments_number"}})</a></li> <li class="j-tab-trigger"><a href="javascript:void(0)">{{i18n "mbox/mail_largeatt"}}({{trsAttachments.length}} {{i18n "mail/attachments_number"}})</a></li> </ul> </div> {{/if}}{{/if}} {{#unless trsAttachments}} <div class="attach-title"> <h3>{{i18n "mbox/mail_normalatt"}}({{attachments.length}} {{i18n "mail/attachments_number"}})</h3> {{#if (gt attachments.length 1)}} {{#if packUrl}} <a target="_blank" href="{{packUrl}}">{{i18n "mbox/pack_mail"}}</a> {{/if}} {{#if attachments.0.nf}} <a class="f-csp j-saveToNetFolder">{{i18n "mbox/add_to_netfolder"}}</a> {{/if}} {{/if}} </div> {{/unless}} {{#unless attachments}} <div class="attach-title"> <h3>{{i18n "mbox/mail_largeatt"}}({{trsAttachments.length}} {{i18n "mail/attachments_number"}})</h3> </div> {{/unless}}'})},845:function(e,t,n){var i=n(512),a=n(525),r=n(846),o=1,s=2,c=3,l=i.create({Implements:a,initialize:function(e,t){this.options=t||{},this.plugin=e||null,this.mimeTree=this._createMimeNode(),this.mailData={},this._multipartTree=[],this._state=o,this._headersSent=!1,this._currentNode=this.mimeTree,this._currentNode.priority='normal',!1!=!!this.plugin&&!1!==this.plugin.valid||this.emit('end','Plugin load failed')},end:function(e){var t,n,i,a=e.split(/\r?\n|\r/);for(n=0,i=a.length;n<i;n++)t=a[n],this._state==o&&!0===this._processStateHeader(t)||this._state!=s||this._processStateBody(t);this._currentNode.content&&this._finalizeContents(),this._state=c,this._processMimeTree()},_processMimeTree:function(){var e,t,n={};if(this.mailData={html:[],text:[],calendar:[],attachments:[]},this.mimeTree.meta.mimeMultipart?this._walkMimeTree(this.mimeTree):this._processMimeNode(this.mimeTree,0),this.mailData.html.length)for(e=0,t=this.mailData.html.length;e<t;e++)!n.html&&this.mailData.html[e].content?n.html=this.mailData.html[e].content:this.mailData.html[e].content&&(n.html=this._concatHTML(n.html,this.mailData.html[e].content));if(this.mailData.text.length)for(e=0,t=this.mailData.text.length;e<t;e++)!n.text&&this.mailData.text[e].content?n.text=this.mailData.text[e].content:this.mailData.text[e].content&&(n.text+=this.mailData.text[e].content);if(this.mailData.calendar.length)for(n.alternatives=[],e=0,t=this.mailData.calendar.length;e<t;e++)n.alternatives.push(this.mailData.calendar[e].content);if(n.headers=this.mimeTree.parsedHeaders,this.mimeTree.subject&&(n.subject=this.mimeTree.subject),this.mimeTree.references&&(n.references=this.mimeTree.references),this.mimeTree.messageId&&(n.messageId=this.mimeTree.messageId),this.mimeTree.inReplyTo&&(n.inReplyTo=this.mimeTree.inReplyTo),this.mimeTree.priority&&(n.priority=this.mimeTree.priority),this.mimeTree.from&&(n.from=this.mimeTree.from),this.mimeTree.replyTo&&(n.replyTo=this.mimeTree.replyTo),this.mimeTree.to&&(n.to=this.mimeTree.to),this.mimeTree.cc&&(n.cc=this.mimeTree.cc),this.mimeTree.bcc&&(n.bcc=this.mimeTree.bcc),this.mimeTree.meta.date&&(n.date=this.mimeTree.meta.date),this.mimeTree.meta.receivedDate&&(n.receivedDate=this.mimeTree.meta.receivedDate),this.mailData.attachments.length)for(n.attachments=[],e=0,t=this.mailData.attachments.length;e<t;e++)n.attachments.push(this.mailData.attachments[e].content);this.emit('end',n)},_processMimeNode:function(e,t,n){var i,a;if(t=t||0,e.attachment)e.meta=e.meta||{},e.content&&(e.meta.content=e.content),e.originalContent&&(e.meta.originalContent=e.originalContent),this.mailData.attachments.push({content:e.meta||{},level:t});else switch(e.meta.contentType){case'text/html':if('mixed'==n&&this.mailData.html.length)for(i=0,a=this.mailData.html.length;i<a;i++)if(this.mailData.html[i].level==t)return void this._joinHTMLNodes(this.mailData.html[i],e.content);return void this.mailData.html.push({content:this._updateHTMLCharset(e.content||''),level:t});case'text/plain':return void this.mailData.text.push({content:e.content||'',level:t});case'text/calendar':e.content&&(e.meta.content=e.content),this.mailData.calendar.push({content:e.meta||{},level:t})}},_createMimeNode:function(e){return{parentNode:e||this._currentNode||null,headers:[],parsedHeaders:{},meta:{},childNodes:[]}},_processStateHeader:function(e){var t=this._currentNode.headers.length-1,n=!1;if(!e.length)return t>=0&&this._processHeaderLine(t),this._headersSent||(this.emit('headers',this._currentNode.parsedHeaders),this._headersSent=!0),this._state=s,t>=0&&this._processHeaderLine(t),this._currentNode.parentNode||this._currentNode.meta.contentType||(this._currentNode.meta.contentType='text/plain'),!(n=['text/plain','text/html','text/calendar'].indexOf(this._currentNode.meta.contentType||'')>=0)||this._currentNode.meta.contentDisposition&&'inline'!=this._currentNode.meta.contentDisposition?n&&!(['attachment','inline'].indexOf(this._currentNode.meta.contentDisposition)>=0)||this._currentNode.meta.mimeMultipart||(this._currentNode.attachment=!0):this._currentNode.attachment=!1,this._currentNode.attachment&&(this._currentNode.meta,this._currentNode.content=undefined),!0;e.match(/^\s+/)&&t>=0?this._currentNode.headers[t]+=' '+e.trim():(this._currentNode.headers.push(e.trim()),t>=0&&this._processHeaderLine(t))},_processStateBody:function(e){var t,n,i,a=!1;if('--'==e.substr(0,2))for(t=0,n=this._multipartTree.length;t<n;t++){if(e=='--'+this._multipartTree[t].boundary){this._currentNode.content&&this._finalizeContents(),i=this._createMimeNode(this._multipartTree[t].node),this._multipartTree[t].node.childNodes.push(i),this._currentNode=i,this._state=o,a=!0;break}if(e=='--'+this._multipartTree[t].boundary+'--'){this._currentNode.content&&this._finalizeContents(),this._isEmptyObject(this._multipartTree[t].node.parentNode)?this._currentNode=this._multipartTree[t].node:this._currentNode=this._multipartTree[t].node.parentNode,this._state=s,a=!0;break}}return!!a||(['text/plain','text/html','text/calendar'].indexOf(this._currentNode.meta.contentType||'')>=0&&!this._currentNode.attachment?this._handleTextLine(e):this._currentNode.attachment&&this._handleAttachmentLine(e),!1)},_processHeaderLine:function(e){var t,n,i,a;if(e=e||0,(a=this._currentNode.headers[e])&&'string'==typeof a){switch(t=(i=a.split(':')).shift().toLowerCase().trim(),n=i.join(':').trim(),t){case'content-type':this._parseContentType(n);break;case'mime-version':this._currentNode.useMIME=!0;break;case'date':this._currentNode.meta.date=this._parseDateString(n);break;case'received':case'x-received':this._parseReceived(n);break;case'to':this._currentNode.to&&this._currentNode.to.length>0?this._currentNode.to=this._currentNode.to.concat(this.plugin.encode().decodeMailbox(n)):this._currentNode.to=this.plugin.encode().decodeMailbox(n);break;case'from':this._currentNode.from&&this._currentNode.from.length>0?this._currentNode.from=this._currentNode.from.concat(n):this._currentNode.from=this.plugin.encode().decodeMailbox(n);break;case'reply-to':this._currentNode.replyTo&&this._currentNode.replyTo.length>0?this._currentNode.replyTo=this._currentNode.replyTo.concat(this.plugin.encode().decodeMailbox(n)):this._currentNode.replyTo=this.plugin.encode().decodeMailbox(n);break;case'cc':this._currentNode.cc&&this._currentNode.cc.length>0?this._currentNode.cc=this._currentNode.cc.concat(this.plugin.encode().decodeMailbox(n)):this._currentNode.cc=this.plugin.encode().decodeMailbox(n);break;case'bcc':this._currentNode.bcc&&this._currentNode.bcc.length>0?this._currentNode.bcc=this._currentNode.bcc.concat(this.plugin.encode().decodeMailbox(n)):this._currentNode.bcc=this.plugin.encode().decodeMailbox(n);break;case'x-priority':case'x-msmail-priority':case'importance':n=this._parsePriority(n),this._currentNode.priority=n;break;case'message-id':this._currentNode.meta.messageId=this._trimQuotes(n),this._currentNode.messageId=this._currentNode.meta.messageId;break;case'references':this._parseReferences(n);break;case'in-reply-to':this._parseInReplyTo(n);break;case'thread-index':this._currentNode.meta.threadIndex=n;break;case'content-transfer-encoding':this._currentNode.meta.transferEncoding=n.toLowerCase();break;case'content-location':this._currentNode.meta.location=n.toLowerCase();break;case'subject':this._currentNode.subject=this._encodeString(n);break;case'content-disposition':this._parseContentDisposition(n);break;case'content-id':this._currentNode.meta.contentId=this._trimQuotes(n)}this._currentNode.parsedHeaders[t]?(Array.isArray(this._currentNode.parsedHeaders[t])||(this._currentNode.parsedHeaders[t]=[this._currentNode.parsedHeaders[t]]),this._currentNode.parsedHeaders[t].push(this._replaceMimeWords(n))):this._currentNode.parsedHeaders[t]=this._replaceMimeWords(n),this._currentNode.headers[e]={key:t,value:n}}},_parseContentType:function(e){var t;return(e=this._parseHeaderLineWithParams(e))&&(e.defaultValue?(e.defaultValue=e.defaultValue.toLowerCase(),this._currentNode.meta.contentType=e.defaultValue,'multipart/'==e.defaultValue.substr(0,'multipart/'.length)&&(this._currentNode.meta.mimeMultipart=e.defaultValue.substr('multipart/'.length))):this._currentNode.meta.contentType='application/octet-stream',e.charset&&(e.charset=e.charset.toLowerCase(),'win-'==e.charset.substr(0,4)?e.charset='windows-'+e.charset.substr(4):'ks_c_5601-1987'==e.charset?e.charset='cp949':e.charset.match(/^utf\d/)?e.charset='utf-'+e.charset.substr(3):e.charset.match(/^latin[-_]?\d/)?e.charset='iso-8859-'+e.charset.replace(/\D/g,''):(e.charset.match(/^(us-)?ascii$/)||e.charset.match(/^ansi_x3\.4-19/))&&(e.charset='utf-8'),this._currentNode.meta.charset=e.charset),e.format&&(this._currentNode.meta.textFormat=e.format.toLowerCase()),e.delsp&&(this._currentNode.meta.textDelSp=e.delsp.toLowerCase()),e.boundary&&(this._currentNode.meta.mimeBoundary=e.boundary),e.method&&(this._currentNode.meta.method=e.method),!this._currentNode.meta.fileName&&(t=this._detectFilename(e))&&(this._currentNode.meta.fileName=t),e.boundary&&(this._currentNode.meta.mimeBoundary=e.boundary,this._multipartTree.push({boundary:e.boundary,node:this._currentNode}))),e},_parseHeaderLineWithParams:function(e){var t,n,i={};n=e.match(/(?:[^;"]+|"[^"]*")+/g)||[e],i.defaultValue=n.shift().toLowerCase();for(var a=0,r=n.length;a<r;a++)t=(e=n[a].split('=')).shift().trim().toLowerCase(),e=e.join('=').trim(),e=this._trimQuotes(e),i[t]=e;return i},_trimQuotes:function(e){return('"'==(e=(e||'').trim()).charAt(0)&&'"'==e.charAt(e.length-1)||'\''==e.charAt(0)&&'\''==e.charAt(e.length-1)||'<'==e.charAt(0)&&'>'==e.charAt(e.length-1))&&(e=e.substr(1,e.length-2)),e},_replaceMimeWords:function(e){return e.replace(/(=\?[^?]+\?[QqBb]\?[^?]*\?=)\s+(?==\?[^?]+\?[QqBb]\?[^?]*\?=)/g,'$1').replace(/=\?[^?]+\?[QqBb]\?[^?]*\?=/g,function(e){return this.plugin.encode().decodeSubject(e.replace(/\s/g,''))}.bind(this))},_parseDateString:function(e){var t;if(t=new Date(e),'[object Date]'!=Object.prototype.toString.call(t)||'Invalid Date'==t.toString()){try{t=r.strtotime(e)}catch(n){return!1}if(!t)return!1;t=new Date(1e3*t)}return t},_parseReceived:function(e){var t,n,i;return!!e&&(i=e.split(';'),e=i[i.length-1],n=this._parseDateString(e),t=this._currentNode.meta.receivedDate,n?(t?n>t&&(this._currentNode.meta.receivedDate=n):this._currentNode.meta.receivedDate=n,n):(t||(this._currentNode.meta.receivedDate=n),n))},_parsePriority:function(e){if(e=e.toLowerCase().trim(),!isNaN(parseInt(e,10)))return 3==(e=parseInt(e,10)||0)?'normal':e>3?'low':'high';switch(e){case'non-urgent':case'low':return'low';case'urgent':case'hight':return'high'}return'normal'},_parseReferences:function(e){this._currentNode.references=(this._currentNode.references||[]).concat((e||'').toString().trim().split(/\s+/).map(this._trimQuotes.bind(this)))},_encodeString:function(e){return e=this._replaceMimeWords(this._convertStringToUTF8(e))},_convertStringToUTF8:function(e){return e=this._convertString(e,this._currentNode.meta.charset||this.options.defaultCharset||'iso-8859-1').toString('utf-8')},_parseContentDisposition:function(e){var t='';if(e=this._parseHeaderLineWithParams(e))if(e.defaultValue&&(this._currentNode.meta.contentDisposition=e.defaultValue.trim().toLowerCase()),e.filename)this._currentNode.meta.fileName=e.filename;else if(e['filename*0*']){for(var n in e)-1!=n.indexOf('filename*')&&(t+=e[n]);this._currentNode.meta.fileName=decodeURIComponent(t.substring(7))}},_parseInReplyTo:function(e){this._currentNode.inReplyTo=(this._currentNode.inReplyTo||[]).concat((e||'').toString().trim().split(/\s+/).map(this._trimQuotes.bind(this)))},_handleTextLine:function(e){['quoted-printable','base64'].indexOf(this._currentNode.meta.transferEncoding)>=0||'flowed'!=this._currentNode.meta.textFormat?'string'!=typeof this._currentNode.content?this._currentNode.content=e:this._currentNode.content+='\n'+e:'string'!=typeof this._currentNode.content?this._currentNode.content=e:this._currentNode.content.match(/[ ]$/)?'flowed'==this._currentNode.meta.textFormat&&this._currentNode.content.match(/(^|\n)-- $/)?this._currentNode.content+='\n'+e:('yes'==this._currentNode.meta.textDelSp&&(this._currentNode.content=this._currentNode.content.replace(/[ ]+$/,'')),this._currentNode.content+=e):this._currentNode.content+='\n'+e},_handleAttachmentLine:function(e){this._currentNode.attachment&&'content'in this._currentNode&&('string'!=typeof this._currentNode.content?this._currentNode.content=e:this._currentNode.content+='\r\n'+e)},_finalizeContents:function(){var e;this._currentNode.content&&(this._currentNode.attachment?(this._currentNode.originalContent=this._currentNode.content,'quoted-printable'==this._currentNode.meta.transferEncoding?(e=this.plugin.encode().decodeQPToBin(this._currentNode.content),this._currentNode.content=this.plugin.encode().encodeCharsetFromBin(e,this._currentNode.meta.charset)):'base64'==this._currentNode.meta.transferEncoding||this._currentNode.meta.transferEncoding,this._currentNode.meta.length=this.plugin.encode().decodeBase64Length(this._currentNode.content)):(this._currentNode.meta.charset||('text/html'==this._currentNode.meta.contentType?this._currentNode.meta.charset=this._detectHTMLCharset(this._currentNode.content)||this.options.defaultCharset||'iso-8859-1':this._currentNode.meta.charset='iso-8859-1'),'quoted-printable'==this._currentNode.meta.transferEncoding?(e=this.plugin.encode().decodeQPToBin(this._currentNode.content),this._currentNode.content=this.plugin.encode().encodeCharsetFromBin(e,this._currentNode.meta.charset),'flowed'==this._currentNode.meta.textFormat&&('yes'==this._currentNode.meta.textDelSp?this._currentNode.content=this._currentNode.content.replace(/(^|\n)-- \n/g,'$1-- \0').replace(/ \n/g,'').replace(/(^|\n)-- \u0000/g,'$1-- \n'):this._currentNode.content=this._currentNode.content.replace(/(^|\n)-- \n/g,'$1-- \0').replace(/ \n/g,' ').replace(/(^|\n)-- \u0000/g,'$1-- \n'))):'base64'==this._currentNode.meta.transferEncoding?(e=this.plugin.encode().decodeBase64ToBin(this._currentNode.content),this._currentNode.content=this.plugin.encode().encodeCharsetFromBin(e,this._currentNode.meta.charset)):this._currentNode.content=this.plugin.encode().encodeCharsetFromBin(this._currentNode.content,this._currentNode.meta.charset)))},_detectFilename:function(e){var t,n,i,a,r='',o=0;if(e.name)return this._replaceMimeWords(e.name);if(e.filename)return this._replaceMimeWords(e.filename);if(e['name*'])r=e['name*'];else if(e['filename*'])r=e['filename*'];else if(e['name*0*']||e['name*0'])for(;a=e['name*'+o+'*']||e['name*'+o];)r+=a,o++;else if(e['filename*0*']||e['filename*0'])for(;a=e['filename*'+o+'*']||e['filename*'+o];)r+=a,o++;return r&&(n=(t=r.split('\'')).shift(),i=t.pop())?this._replaceMimeWords(this._replaceMimeWords('=?'+(n||'us-ascii')+'?Q?'+i.replace(/%/g,'=')+'?=')):''},_detectHTMLCharset:function(e){var t,n,i;return'string'!=typeof e&&(e=e.toString('ascii')),(i=e.match(/<meta\s+http-equiv=["']content-type["'][^>]*?>/i))&&(n=i[0]),n&&(t=n.match(/charset\s?=\s?([a-zA-Z\-_:0-9]*);?/))&&(t=(t[1]||'').trim().toLowerCase()),!t&&(i=e.match(/<meta\s+charset=["']([^'"</]*?)["']/i))&&(t=(i[1]||'').trim().toLowerCase()),t},_joinHTMLNodes:function(e,t){var n=!1;(t=(t=(t=(t||'').toString('utf-8').trim()).replace(/^\s*<!doctype( [^>]*)?>/gi,'')).replace(/<head( [^>]*)?>(.*)<\/head( [^>]*)?>/gi,'').replace(/<\/?html( [^>]*)?>/gi,'').trim()).replace(/<body(?: [^>]*)?>(.*)<\/body( [^>]*)?>/gi,(function(e,n){t=n.trim()})),e.content=(e.content||'').toString('utf-8').trim(),e.content=e.content.replace(/<\/body( [^>]*)?>/i,(function(e){return n=!0,'<br/>\n'+t+e})),n||(e.content+='<br/>\n'+t)},_updateHTMLCharset:function(e){return e=e.replace(/\n/g,'\0').replace(/<meta[^>]*>/gi,(function(e){return e.match(/http-equiv\s*=\s*"?content-type/i)?'<meta http-equiv="content-type" content="text/html; charset=utf-8" />':e.match(/\scharset\s*=\s*['"]?[\w-]+["'\s>/]/i)?'<meta charset="utf-8"/>':e})).replace(/\u0000/g,'\n')},_walkMimeTree:function(e,t){t=t||1;for(var n=0,i=e.childNodes.length;n<i;n++)this._processMimeNode(e.childNodes[n],t,e.meta.mimeMultipart),this._walkMimeTree(e.childNodes[n],t+1)},_concatHTML:function(e,t){var n='',i='';return e=(e||'').toString('utf-8'),(t=(t||'').toString('utf-8'))?e?(e.substr(0,1024).replace(/\r?\n/g,'\0').match(/^[\s\u0000]*(<!doctype\b[^>]*?>)?[\s\u0000]*<(html|head)\b[^>]*?>/i)?n=e:t.substr(0,1024).replace(/\r?\n/g,'\0').match(/^[\s\u0000]*(<!doctype\b[^>]*?>)?[\s\u0000]*<(html|head)\b[^>]*?>/i)&&(n=t),n&&n.replace(/\r?\n/g,'\0').replace(/^[\s\u0000]*(<!doctype\b[^>]*?>)?[\s\u0000]*<(html|head)\b[^>]*>.*?<\/(head)\b[^>]*>(.*?<body\b[^>]*>)?/i,(function(e){var t=e.match(/^[\s\u0000]*(<!doctype\b[^>]*?>)/i),n=e.match(/<html\b[^>]*?>/i),a=e.match(/<head\b[^>]*?>/i),r=e.match(/<body\b[^>]*?>/i);t=t&&t[1]&&t[1]+'\n'||'',n=n&&n[0]||'<head>',a=a&&a[0]||'<head>',r=r&&r[0]||'<body>',e=e.replace(/<[!/]?(doctype|html|head|body)\b[^>]*?>/gi,'\0').replace(/\u0000+/g,'\n').trim(),i=t+n+'\n'+a+(e?e+'\n':'')+'</head>\n'+r+'\n'})),e=e.replace(/\r?\n/g,'\0').replace(/[\s\u0000]*<head\b[^>]*>.*?<\/(head|body)\b[^>]*>/gi,'').replace(/[\s\u0000]*<[!/]?(doctype|html|body)\b[^>]*>[\s\u0000]*/gi,'').replace(/\u0000/g,'\n'),t=t.replace(/\r?\n/g,'\0').replace(/[\s\u0000]*<head\b[^>]*>.*?<\/(head|body)\b[^>]*>/gi,'').replace(/[\s\u0000]*<[!/]?(doctype|html|body)\b[^>]*>[\s\u0000]*/gi,'').replace(/\u0000/g,'\n'),i+e+t+(i?(e||t?'\n':'')+'</body>\n</html>':'')):t:e},_convertString:function(e,t,n){return(n=(n||'utf-8').toUpperCase())==(t=(t||'utf-8').toUpperCase())?e:e=this.plugin.encode().encodeCharset(e,n,t)},_isEmptyObject:function(e){var t;for(t in e)return!1;return!0}});e.exports=l},846:function(e,t,n){var i;(i=function(e,t,n){t.strtotime=function(e,t){var n,i,a,r='',o='';if('now'==(r=(r=(r=e).replace(/\s{2,}|^\s|\s$/g,' ')).replace(/[ \r\n]/g,'')))return(new Date).getTime()/1e3;if(!isNaN(o=Date.parse(r)))return o/1e3;t=t?new Date(1e3*t):new Date;r=r.toLowerCase();var s={day:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},mon:{jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11}},c=function(e){var n=e[2]&&'ago'==e[2],i=('last'==e[0]?-1:1)*(n?-1:1);switch(e[0]){case'last':case'next':switch(e[1].substring(0,3)){case'yea':t.setFullYear(t.getFullYear()+i);break;case'mon':t.setMonth(t.getMonth()+i);break;case'wee':t.setDate(t.getDate()+7*i);break;case'day':t.setDate(t.getDate()+i);break;case'hou':t.setHours(t.getHours()+i);break;case'min':t.setMinutes(t.getMinutes()+i);break;case'sec':t.setSeconds(t.getSeconds()+i);break;default:var a;if(void 0!==(a=s.day[e[1].substring(0,3)])){var r=a-t.getDay();0===r?r=7*i:r>0?'last'==e[0]&&(r-=7):'next'==e[0]&&(r+=7),t.setDate(t.getDate()+r)}}break;default:if(!/\d+/.test(e[0]))return!1;switch(i*=parseInt(e[0],10),e[1].substring(0,3)){case'yea':t.setFullYear(t.getFullYear()+i);break;case'mon':t.setMonth(t.getMonth()+i);break;case'wee':t.setDate(t.getDate()+7*i);break;case'day':t.setDate(t.getDate()+i);break;case'hou':t.setHours(t.getHours()+i);break;case'min':t.setMinutes(t.getMinutes()+i);break;case'sec':t.setSeconds(t.getSeconds()+i)}}return!0};if(i=r.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/)){for(n in i[2]?i[3]||(i[2]+=':00'):i[2]='00:00:00',a=i[1].split(/-/g),s.mon)s.mon[n]==a[1]-1&&(a[1]=n);return a[0]=parseInt(a[0],10),a[0]=a[0]>=0&&a[0]<=69?'20'+(a[0]<10?'0'+a[0]:a[0]+''):a[0]>=70&&a[0]<=99?'19'+a[0]:a[0]+'',parseInt(this.strtotime(a[2]+' '+a[1]+' '+a[0]+' '+i[2])+(i[4]?i[4]/1e3:''),10)}if(!(i=r.match(new RegExp('([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?','gi'))))return!1;for(n=0;n<i.length;n++)if(!c(i[n].split(' ')))return!1;return t.getTime()/1e3}}.call(t,n,t,e))===undefined||(e.exports=i)},847:function(e,t,n){var i=n(475);function a(e,t,n){this.nodeCounter=0,t=t||{},this.cmPlugin=n||null,this.baseBoundary=t.baseBoundary||Date.now().toString()+Math.random(),this.date=new Date,this.rootNode=t.rootNode||this,t.filename&&(this.filename=t.filename,e||(e=this.cmPlugin.mime().getContentTypeByExt(this.filename.split('.').pop()))),this.parentNode=t.parentNode,this._nodeId=++this.rootNode.nodeCounter,this._childNodes=[],this._headers=[],e&&this.setHeader('content-type',e)}a.prototype.createChild=function(e,t){t||'object'!=typeof e||(t=e,e=undefined);var n=new a(e,t,this.cmPlugin);return this.appendChild(n),n},a.prototype.appendChild=function(e){return e.rootNode!==this.rootNode&&(e.rootNode=this.rootNode,e._nodeId=++this.rootNode.nodeCounter),e.parentNode=this,this._childNodes.push(e),e},a.prototype.remove=function(){if(!this.parentNode)return this;for(var e=this.parentNode._childNodes.length-1;e>=0;e--)if(this.parentNode._childNodes[e]===this)return this.parentNode._childNodes.splice(e,1),this.parentNode=undefined,this.rootNode=this,this},a.prototype.setHeader=function(e,t){var n,i=!1;if(!t&&e&&'object'==typeof e)return e.key&&e.value?this.setHeader(e.key,e.value):Array.isArray(e)?e.forEach(function(e){this.setHeader(e.key,e.value)}.bind(this)):Object.keys(e).forEach(function(t){this.setHeader(t,e[t])}.bind(this)),this;n={key:e=this._normalizeHeaderKey(e),value:t};for(var a=0,r=this._headers.length;a<r;a++)this._headers[a].key===e&&(i?(this._headers.splice(a,1),a--,r--):(this._headers[a]=n,i=!0));return i||this._headers.push(n),this},a.prototype.addHeader=function(e,t){return!t&&e&&'object'==typeof e?(e.key&&e.value?this.addHeader(e.key,e.value):Array.isArray(e)?e.forEach(function(e){this.addHeader(e.key,e.value)}.bind(this)):Object.keys(e).forEach(function(t){this.addHeader(t,e[t])}.bind(this)),this):(this._headers.push({key:this._normalizeHeaderKey(e),value:t}),this)},a.prototype.getHeader=function(e){e=this._normalizeHeaderKey(e);for(var t=0,n=this._headers.length;t<n;t++)if(this._headers[t].key===e)return this._headers[t].value},a.prototype.setContent=function(e,t){switch(t){case'base64':this.base64Content=e;break;case'plain':this.content=e}return this},a.prototype.build=function(){var e,t=[];if(this.content&&(e=(this.getHeader('Content-Transfer-Encoding')||'').toString().toLowerCase().trim())&&this.setHeader('Content-Transfer-Encoding',e),this.filename&&!this.getHeader('Content-Disposition')&&this.setHeader('Content-Disposition','attachment'),this._headers.forEach(function(e){var n,i=e.key,a=e.value;switch(e.key){case'Content-Disposition':n=this._parseHeaderValue(a),this.filename&&(n.params.filename=this.filename),a=this._buildHeaderValue(n);break;case'Content-Type':if(n=this._parseHeaderValue(a),this._handleContentType(n),n.value.match(/pkcs7-mime$/))break;n.value.match(/^text\//)&&'string'==typeof this.content&&/[\u0080-\uFFFF]/.test(this.content)&&(n.params.charset='utf-8'),a=this._buildHeaderValue(n)}((a=this._encodeHeaderValue(i,a))||'').toString().trim()&&t.push(this._foldLines(i+': '+a,76))}.bind(this)),this.rootNode===this&&(this.getHeader('Date')||t.push('Date: '+this.date.toUTCString().replace(/GMT/,'+0000')),this.getHeader('Message-Id')||t.push('Message-Id: <'+[0,0,0].reduce((function(e){return e+'-'+Math.floor(4294967296*(1+Math.random())).toString(16).substring(1)}),Date.now())+'@'+(this.getEnvelope().from||'localhost').split('@').pop()+'>'),this.getHeader('MIME-Version')||t.push('MIME-Version: 1.0')),t.push(''),this.base64Content&&t.push(this.base64Content),this.content){switch(e){case'base64':t.push(this._addSoftLinebreaks(this.cmPlugin.encode().encodeBase64(this.content)));break;default:/(\r?\n)$/.test(this.content)||(this.content=this.content+'\r\n'),t.push(this.content.replace(/\r?\n/g,'\r\n'))}this.multipart&&t.push('')}return this.multipart&&(this._childNodes.forEach(function(e){t.push('--'+this.boundary),t.push(e.build())}.bind(this)),t.push('--'+this.boundary+'--'),t.push('')),t.join('\r\n')},a.prototype.getEnvelope=function(){var e={from:!1,to:[]};return this._headers.forEach(function(t){var n=[];'From'===t.key||!e.from&&['Reply-To','Sender'].indexOf(t.key)>=0?(this._convertAddresses(this._parseAddresses(t.value),n),n.length&&n[0]&&(e.from=n[0])):['To','Cc','Bcc'].indexOf(t.key)>=0&&this._convertAddresses(this._parseAddresses(t.value),e.to)}.bind(this)),e},a.prototype._parseAddresses=function(e){return[].concat.apply([],[].concat(e).map((function(e){return i.parse(e)})))},a.prototype._normalizeHeaderKey=function(e){return(e||'').toString().replace(/\r?\n|\r/g,' ').trim().toLowerCase().replace(/^MIME\b|^[a-z]|-[a-z]/gi,(function(e){return e.toUpperCase()}))},a.prototype._buildHeaderValue=function(e){var t=[];return Object.keys(e.params||{}).forEach(function(n){'filename'===n?this._continuationEncode(n,e.params[n],50).forEach((function(e){t.push(e.key+'='+e.value)})):t.push(n+'='+this._escapeHeaderArgument(e.params[n]))}.bind(this)),e.value+(t.length?'; '+t.join('; '):'')},a.prototype._continuationEncode=function(e,t,n){var i,a,r=[],o=0,s=!1;if(n=n||50,/^[\w.\- ]*$/.test(t)){if(t.length<=n)return[{key:e,value:/[\s";=]/.test(t)?'"'+t+'"':t}];(t=t.replace(new RegExp('.{'+n+'}','g'),(function(e){return r.push({line:e}),''})))&&r.push({line:t})}else{a='utf-8\'\'',s=!0,o=0;for(var c=0,l=t.length;c<l;c++){if(i=t[c],s)i=encodeURIComponent(i);else if((i=' '===i?i:encodeURIComponent(i))!==t[c]){if(!((encodeURIComponent(a)+i).length>=n)){s=!0,c=o,a='';continue}r.push({line:a,encoded:s}),a='',o=c-1}(a+i).length>=n?(r.push({line:a,encoded:s}),a=i=' '===t[c]?' ':encodeURIComponent(t[c]),i===t[c]?(s=!1,o=c-1):s=!0):a+=i}a&&r.push({line:a,encoded:s})}return r.map((function(t,n){return{key:e+'*'+n+(t.encoded?'*':''),value:/[\s";=]/.test(t.line)?'"'+t.line+'"':t.line}}))},a.prototype._escapeHeaderArgument=function(e){return e.match(/[\s'"\\;/=]|^-/g)?'"'+e.replace(/(["\\])/g,'\\$1')+'"':e},a.prototype._handleContentType=function(e){this.contentType=e.value.trim().toLowerCase(),this.multipart=this.contentType.split('/').reduce((function(e,t){return'multipart'===e&&t})),this.multipart?this.boundary=e.params.boundary=e.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1},a.prototype._generateBoundary=function(){return'----Coremail_Part_Boundary-?=_'+this._nodeId+'-'+this.rootNode.baseBoundary},a.prototype._encodeHeaderValue=function(e,t){switch(e=this._normalizeHeaderKey(e)){case'From':case'Sender':case'To':case'Cc':case'Bcc':case'Reply-To':return this._convertAddresses(this._parseAddresses(t));case'Message-Id':case'In-Reply-To':case'Content-Id':return'<'!==(t=(t||'').toString().replace(/\r?\n|\r/g,' ')).charAt(0)&&(t='<'+t),'>'!==t.charAt(t.length-1)&&(t+='>'),t;case'References':return(t=[].concat.apply([],[].concat(t||'').map((function(e){return(e=(e||'').toString().replace(/\r?\n|\r/g,' ').trim()).replace(/<[^>]*>/g,(function(e){return e.replace(/\s/g,'')})).split(/\s+/)}))).map((function(e){return'<'!==e.charAt(0)&&(e='<'+e),'>'!==e.charAt(e.length-1)&&(e+='>'),e}))).join(' ').trim();case'Subject':return this.cmPlugin.encode().encodeSubject(t);default:return t=(t||'').toString().replace(/\r?\n|\r/g,' ')}},a.prototype._convertAddresses=function(e,t){var n=[];return t=t||[],[].concat(e||[]).forEach(function(e){e.address&&(e.trueName?n.push(this.cmPlugin.encode().encodeMailbox(e.trueName+' <'+e.address+'>')):n.push(this.cmPlugin.encode().encodeMailbox(e.address))),t.indexOf(e.address)<0&&t.push(e.address)}.bind(this)),n.join(', ')},a.prototype._parseHeaderValue=function(e){for(var t,n={value:!1,params:{}},i=!1,a='',r='value',o=!1,s=!1,c=0,l=e.length;c<l;c++)if(t=e.charAt(c),'key'===r){if('='===t){i=a.trim().toLowerCase(),r='value',a='';continue}a+=t}else{if(s)a+=t;else{if('\\'===t){s=!0;continue}o&&t===o?o=!1:o||'"'!==t?o||';'!==t?a+=t:(!1===i?n.value=a.trim():n.params[i]=a.trim(),r='key',a=''):o=t}s=!1}return'value'===r?!1===i?n.value=a.trim():n.params[i]=a.trim():a.trim()&&(n.params[a.trim().toLowerCase()]=''),Object.keys(n.params).forEach((function(e){var t,i,a,r;(a=e.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(t=e.substr(0,a.index),i=Number(a[2]||a[3])||0,n.params[t]&&'object'==typeof n.params[t]||(n.params[t]={charset:!1,values:[]}),r=n.params[e],0===i&&'*'===a[0].substr(-1)&&(a=r.match(/^([^']*)'[^']*'(.*)$/))&&(n.params[t].charset=a[1]||'iso-8859-1',r=a[2]),n.params[t].values[i]=r,delete n.params[e])})),Object.keys(n.params).forEach((function(e){var t;n.params[e]&&Array.isArray(n.params[e].values)&&(t=n.params[e].values.map((function(e){return e||''})).join(''),n.params[e].charset?n.params[e]='=?'+n.params[e].charset+'?Q?'+t.replace(/[=?_\s]/g,(function(e){var t=e.charCodeAt(0).toString(16);return' '===e?'_':'%'+(t.length<2?'0':'')+t})).replace(/%/g,'=')+'?=':n.params[e]=t)})),n},a.prototype._foldLines=function(e,t,n){t=t||76;for(var i,a,r=0,o=(e=(e||'').toString()).length,s='';r<o;){if((i=e.substr(r,t)).length<t){s+=i;break}(a=i.match(/^[^\n\r]*(\r?\n|\r)/))?(s+=i=a[0],r+=i.length):((a=i.match(/(\s+)[^\s]*$/))&&a[0].length-(n?(a[1]||'').length:0)<i.length?i=i.substr(0,i.length-(a[0].length-(n?(a[1]||'').length:0))):(a=e.substr(r+i.length).match(/^[^\s]+(\s*)/))&&(i+=a[0].substr(0,a[0].length-(n?0:(a[1]||'').length))),s+=i,(r+=i.length)<o&&(s+='\r\n'))}return s},a.prototype._addSoftLinebreaks=function(e){return(e||'').toString().trim().replace(new RegExp('.{76}','g'),'$&\r\n').trim()},e.exports=a}}]);
//# sourceMappingURL=C~M.c2f53.js.map